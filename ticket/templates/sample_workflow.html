
<!DOCTYPE html>
<html>
    <head>
        <title>            Edit Workflow
    </title>
    </head>



    <body class=" ">

        <div class="uv-loader-view">
            <div class="uv-loader">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>

        <div class="uv-pop-up-overlay" id="confirm-modal">
            <div class="uv-pop-up-box uv-pop-up-slim">
                <span class="uv-pop-up-close"></span>
                <h2>Confirm Action</h2>
                <p>Are you sure you want to perform this action?</p>

                <div class="uv-pop-up-actions">
                    <a href="#" class="uv-btn uv-btn-error confirm">Confirm</a>
                    <a href="#" class="uv-btn cancel">Cancel</a>
                </div>
            </div>
        </div>



	<script type="text/javascript">
		document.addEventListener("DOMContentLoaded", function(e) {
			window.dispatchEvent(new Event('resize'));
		    var uvView = document.querySelector(".uv-view");
			if(uvView && uvView.offsetWidth <= 1340) {
				document.cookie = "uv-sidebar-status=1; expires=Wed, 01 Jan 2020 00:00:00 GMT;path=/";
			}
		});
	</script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        fetch('/public/tracker/xhr/get/cacheImage')
            .then(response => response.json())
            .then(data => {
                const logoImg = document.querySelector('.uv-logo img');
                if (logoImg) {
                    // Set the image source to the URL provided by the server
                    logoImg.src = data;
                }
            })
            .catch(error => console.error('Error fetching the image path:', error));
    });
</script>
                    <div class="uv-paper">
                                    <!-- Navbar -->
<style>
    .uv-navbar .uv-notification-list li {
        cursor: default;
        font-size: 15px !important;
    }
    .uv-navbar .uv-notification-list li * {
        display: inline-block !important;
    }
    .uv-navbar .uv-notification-list li a {
         color: #2750C4 !important;
    }
    .uv-navbar .uv-notification-list ul {
        max-height: 320px !important;
    }
    .uv-navbar .uv-notification-list .timeago {
        color: #9E9E9E;
        margin-top: 5px;
        font-size: 13px;
    }
    .uv-navbar .uv-dropdown-container.load-more {
        border-top: solid 1px #D3D3D3;
        text-align: center;
    }
    .uv-navbar .uv-dropdown-container.load-more a {
        color: #333;
        text-transform: capitalize;
        font-size: 15px;
        font-weight: 500;
    }
    .uv-text-left .uv-dropdown-container {
        overflow:  unset !important;
        max-height: unset !important;
    }
    .uv-navbar .uv-icon-load-more {
        margin-right: 5px;
    }
    .uv-plan-list-item .uv-text-light-color {
        color: #9E9E9E;
    }
    .uv-plan-list-item .uv-plan-badge {
        color: #FFFFFF;
        font-size: 12px;
        padding: 1px 5px;
        border-radius: 3px;
        margin-left: 5px;
        display: inline-block;
        text-transform: uppercase;
    }
    .uv-plan-list-item .uv-plan-badge-color-free {
        background: #4486ee;
    }
    .uv-plan-list-item .uv-plan-badge-color-pro {
        background: #f5d02a;
    }
    .uv-plan-list-item .uv-plan-badge-color-enterprise {
        background: #fd9a9a;
    }
    .uv-plan-list-item .uv-plan-badge-color-customized {
        background: #b77af5;
    }
    .uv-onboard-navigator {
        cursor: pointer;
    }
    .uv-margin-icon-srch {
        margin: 5px 0px 0px 5px;
    }

    .uv-mob-aside{
        position: fixed;
        z-index: 999;
        top: 105px;
        left: 288px;
        transition: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .uv-sidebar.uv-sidebar-active ~ .uv-paper .uv-mob-aside{
        left: 320px;
    }
    .uv-mob-aside.uv-mob-aside-collapsed{
        left: 286px;
    }
    .uv-sidebar.uv-sidebar-active ~ .uv-paper .uv-mob-aside.uv-mob-aside-collapsed{
        left: 45px;
    }
    .uv-view.uv-aside-view{
        padding: 25px 0px 25px 25px;
    }
    .uv-inner-section .uv-view.uv-aside-view .uv-ticket-scroll-region.uv-aside-view-tv{
        left: 20px;
    }
    .uv-mob-aside .uv-icon-aside-menu,.uv-mob-aside .uv-icon-aside-menu:hover {
        background-position: 1px -497px;
    }
    .uv-mob-aside-collapsed .uv-icon-aside-menu, .uv-mob-aside-collapsed .uv-icon-aside-menu:hover {
        background-position: 5px -497px;
    }
    .uv-mob-aside:not(.uv-mob-aside-collapsed) .uv-icon-aside-menu,.uv-mob-aside:not(.uv-mob-aside-collapsed) .uv-icon-aside-menu:hover {
        -ms-transform: rotate(180deg);
        -webkit-transform: rotate(180deg);
        transform: rotate(180deg);
    }
    .uv-mob-aside:not(.uv-mob-aside-collapsed) .uv-icon-aside-menu:hover,.uv-rtl .uv-mob-aside.uv-mob-aside-collapsed .uv-icon-aside-menu:hover {
        box-shadow: 0px -8px 15px 3px rgba(0, 0, 0, 0.15), 0px -2px 3px 0px rgba(0, 0, 0, 0.2);
    }
    .uv-rtl .uv-mob-aside:not(.uv-mob-aside-collapsed) .uv-icon-aside-menu,.uv-rtl .uv-mob-aside:not(.uv-mob-aside-collapsed) .uv-icon-aside-menu:hover {
        -ms-transform: unset;
        -webkit-transform: unset;
        transform: unset;
    }
    .uv-rtl .uv-mob-aside.uv-mob-aside-collapsed .uv-icon-aside-menu,.uv-rtl .uv-mob-aside.uv-mob-aside-collapsed .uv-icon-aside-menu:hover {
        -ms-transform: rotate(180deg)!important;
        -webkit-transform: rotate(180deg)!important;
        transform: rotate(180deg)!important;
    }
    .uv-rtl .uv-sidebar.uv-sidebar-active ~ .uv-paper .uv-mob-aside{
        right: 320px;
        left: unset;
    }
    .uv-rtl .uv-mob-aside.uv-mob-aside-collapsed{
        right: 286px;
    }
    .uv-rtl .uv-sidebar.uv-sidebar-active ~ .uv-paper .uv-mob-aside.uv-mob-aside-collapsed{
        right: 45px;
    }
    .uv-rtl .uv-inner-section .uv-view.uv-aside-view .uv-ticket-scroll-region.uv-aside-view-tv{
        right: 20px;
    }
    .uv-rtl .uv-sidebar:not(.uv-sidebar-active) ~ .uv-paper .uv-mob-aside:not(.uv-mob-aside-collapsed) {
        right: 560px
    }
    .uv-rtl .uv-mob-aside{
        left: unset;
    }
    .uv-menubar.uv-language .uv-dropdown-list {
        z-index: 19999;
    }

    .user-name {
        font-weight: 800;
        margin-top: 2px;
        font-size: medium;
    }

    @media screen and (min-width: 901px) and (max-width: 1400px) {
        .uv-sidebar.uv-sidebar-active ~ .uv-paper .uv-mob-aside{
            left: 290px;
        }
        .uv-mob-aside.uv-mob-aside-collapsed{
            left: 40px;
        }
        .uv-rtl .uv-sidebar.uv-sidebar-active ~ .uv-paper .uv-mob-aside{
            right: 290px;
        }
        .uv-rtl  .uv-mob-aside.uv-mob-aside-collapsed{
            right: 52px;
        }
    }
    @media screen and (max-width: 1024px) {
        .uv-mob-aside{
            top: 48px;
            left: 80px!important;
        }
        .uv-mob-aside-collapsed .uv-icon-aside-menu, .uv-mob-aside-collapsed .uv-icon-aside-menu:hover {
            background-position: 1px -497px;
        }
        .uv-sidebar ul.uv-menubar li a {
            max-width: 60px !important;
        }
        .uv-sidebar .uv-soft-top .uv-company-logo {
            width: unset;
        }
        #google_translate_element .goog-te-gadget-simple {
            width: 26px;
            overflow: hidden;
            font-size: 0px;
            padding: 3px 2px 2px 2px;
        }
    }
    @media screen and (max-width: 400px) {
        #google_translate_element {
            display: none;
        }
    }
    .uv-rtl .uv-mob-aside{
        right: 320px;
    }
    .uv-pop-up-body .uv-mob-aside {
        display: none;
        transition: none;
    }
    .uv-rtl .uv-view.uv-aside-view{
        padding: 25px 25px 25px 0px;
    }
    .uv-rtl .uv-inner-section .uv-view.uv-aside-view .uv-ticket-scroll-region.uv-aside-view-tv{
        left: 0px;
        right: 20px;
    }
    .uv-filter-view .uv-filter-head .uv-filter-toggle span{
        background-position: -21px -245px;
    }
    .uv-view.uv-aside-view{
        padding: 25px 0px 25px 25px;
    }
    .uv-inner-section .uv-view.uv-aside-view .uv-ticket-scroll-region.uv-aside-view-tv{
        left: 20px;
    }
    .uv-rtl .uv-view.uv-aside-view{
        padding: 25px 25px 25px 0px;
    }
    .uv-rtl .uv-inner-section .uv-view.uv-aside-view .uv-ticket-scroll-region.uv-aside-view-tv{
        left: 0px;
        right: 20px;
    }
    .uv-filter-view .uv-filter-head .uv-filter-toggle span{
        background-position: -21px -245px;
    }


    .uv-inner-section .uv-view.uv-aside-view .uv-ticket-fixed-region{
        left: 20px;
    }

    .uv-rtl .uv-inner-section .uv-view.uv-aside-view .uv-ticket-fixed-region {
        left: 0px;
        right: 20px;
    }

    div.mce-edit-area {
        margin-right: 1px!important;
    }

    .uv-whats-newlist li img {
        width: 40px;
    }
    .uv-got-whats-new {
        background-color: #7C70F4;
        border-radius: 50%;
        padding: 4px;
        border: 2px solid white;
        position: absolute;
        top: -3px;
        right: -3px;
    }
    .uv-feature-title {
        vertical-align: top;
        font-size: 18px;
        margin: 5px 0 0 5px;
        word-wrap: break-word;
        display: inline-block;
    }
    .uv-feature-content {
        margin: 2px 0 0 0;
    }
    .uv-dropdown-list ul .uv-feature-link, .uv-dropdown-list ul .uv-feature-link:link, .uv-dropdown-list ul .uv-feature-link:active, .uv-dropdown-list ul .uv-feature-link:visited, .uv-dropdown-list ul .uv-feature-link:focus {
        color: #2750C4;
        font-size: 15px;
        margin-top: 10px;
    }
    .uv-dropdown-list ul.uv-search-list li.uv-whats-li {
        border-top: none;
        padding-top: 5px;
    }
    .uv-whats-newlist + .uv-notification-list {
        margin-left: 15px;
    }
    .uv-search-result-wrapper a:focus > .uv-search-result-row {
        background-color: #f0f0f0;
    }
    .uv-loader-view ~ .uv-notifications-wrapper {
        z-index: 9999;
    }
    .mce-notification-error {
        display: none;
    }
    ul.uv-flag-notice-list {
        color: #333333;
        border-top: solid 1px #D3D3D3;
        border-bottom: solid 1px #D3D3D3;
        padding: 15px 20px;
        background: #FAFAFA;
    }
    .uv-dropdown-list ul.uv-search-list.flags-active li:first-child {
        border-top: unset;
    }

    .dropdown-divider {
        border-top: 1px solid #e1e4e8;
        display: block;
        height: 0;
        margin: 10px 0 10px -19px;
        width: 195px;
    }
</style>

<script type="text/template" id="notification_flags_temp">
    <% if (typeof undeliveredMessages != 'undefined') { %>
        <li>
            <span class="uv-notification-message">
                <%= undeliveredMessages %>
            </span>
        </li>
        <span class="timeago">Learn more about <a href="https://support.uvdesk.com/en/blog/uvdesk-ticket-delivery-status" target="_blank">ticket delivery status</a>.</span>
    <% } %>
</script>

<script type="text/javascript">
    $(function () {
        var FeatureSearch = Backbone.View.extend({
            el: $('.uv-search-wrapper'),
            events: {
                'keyup .uv-search-bar': 'searchFeature',
                'click .uv-search-bar': 'openFeatureSearch',
            },
            searchFeature: function(e) {
                var currentElement = Backbone.$(e.currentTarget);
                if(currentElement.val().trim() != '') {
                    var flag = 0;
                    $('.uv-search-wrapper').find('.uv-search-result-row').each(function() {
                        if(!$(this).hasClass('uv-no-results')) {
                            var text = $(this).text().trim().toLowerCase();
                            var isTextContained = text.search(currentElement.val().trim().toLowerCase());
                            if(isTextContained < 0) {
                                $(this).parent().hide();
                                $(this).parent().attr('tabIndex', -1);
                            } else {
                                $(this).parent().show();
                                $(this).parent().removeAttr('tabIndex');
                                flag = 1;
                            }
                        }
                    });
                    if(flag == 0)
                        $('.uv-search-wrapper').find(".uv-no-results").show();
                    else
                        $('.uv-search-wrapper').find(".uv-no-results").hide();

                    this.$el.find('.uv-search-result-wrapper').addClass('uv-search-result-active').addClass('uv-search-flap-up')
                } else {
                    this.$el.find('.uv-search-result-wrapper').removeClass('uv-search-result-active').removeClass('uv-search-flap-up')
                }
            },
            openFeatureSearch: function(e) {
                var currentElement = Backbone.$(e.currentTarget);
                if(currentElement.val().trim() != '') {
                    this.$el.find('.uv-search-result-wrapper').addClass('uv-search-result-active').addClass('uv-search-flap-up')
                }
            }
        });

        var SidePanelUV = Backbone.View.extend({
            el: $('.uv-paper'),
            events: {
                'click .uv-mob-aside span': 'toggleAsideBar'
            },
            initialize : function() {
                var ele = $('.uv-paper');
                if(ele.css('padding-left') == '60px'){
                    $('.uv-mob-aside').removeClass('uv-mob-aside-left');
                }else{
                    $('.uv-mob-aside').addClass('uv-mob-aside-left');
                }

                var asideView = '';
                if(asideView == 'true')
                    this.toggleAsideBar();
            },
            toggleAsideBar: function(){
                var asideView = true;
                var ele = $('.uv-inner-section .uv-aside');
                var eleSidePanel = $('.uv-inner-section .uv-view');
                var eleTicketView = $('.uv-inner-section .uv-view .uv-ticket-scroll-region');
                var mobAside = $('.uv-mob-aside');
                if(ele.css('display') == 'none'){
                    asideView = false;
                    ele.css('display', 'block');
                    eleSidePanel.removeClass('uv-aside-view');
                    eleTicketView.removeClass('uv-aside-view-tv');
                    mobAside.removeClass('uv-mob-aside-collapsed')
                }else{
                    ele.css('display', 'none');
                    eleSidePanel.addClass('uv-aside-view');
                    eleTicketView.addClass('uv-aside-view-tv');
                    mobAside.addClass('uv-mob-aside-collapsed')
                }
                if(asideView) {
                    document.cookie = ("uv-asideView=1; expires=Wed, 01 Jan 2020 00:00:00 GMT;path=/");
                } else {
                    document.cookie = ("uv-asideView=0; expires=Wed, 01 Jan 2020 00:00:00 GMT;path=/");
                }
            }
        });

        var featureSearch =  new FeatureSearch();
        var sidePanelUV =  new SidePanelUV();
    });
</script>

    <style>
    .mce-path {
      		display: none !important;
	}
</style>


    <style>
    input.attachment {
        display: none;
    }

    .uv-element-block .uv-added-attachment {
        color: #333333;
        margin: -14px 5px;
    }
</style>

<script type="text/javascript">
    $(function () {
        var FileView = Backbone.View.extend({
            fileCounter: 0,
            max_post_size: 8388608,
            max_file_uploads: 20,
            upload_max_filesize: 2097152,
            el: '.attachment-block',
            events : {
                'click .uv-file-label': 'createFileType',
                'change .attachment': 'selectFile',
                'click .uv-added-attachment span': 'removeFile',
                'click .uv-field-message': 'removeError',
            },
            createFileType: function(e) {
                this.removeError(e)
                var currentElement = Backbone.$(e.currentTarget),
                    attachmentBlock = currentElement.parents('.attachment-block')
                if (attachmentBlock.children('.uv-added-attachment').length + 1 > this.max_file_uploads) {
                    attachmentBlock.append(this.getDefaultErrorMessage())
                    return;
                }
                this.fileCounter += 1;
                attachmentBlock.append('<div class="uv-added-attachment" style="display: none" id="file-' + this.fileCounter + '"><div class="uv-attachment"><input type="file" name="attachments[]" class="attachment" multiple="multiple"></div></div>')
                $('#file-' + this.fileCounter).find('.attachment').trigger('click')
            },
            labelTemplate: _.template('<div data-name="<%- fileName %>" class="uv-selected-attachment-item"><span></span><label class="file-name"><%- fileName %></label></div>'),
            selectFile: function(e) {
                var currentElement = Backbone.$(e.currentTarget);
                var attachmentBlock = currentElement.parents(".uv-added-attachment");
                var isError = false;

                if (currentElement.length) {
                    files = currentElement[0].files;

                    if (files.length) {
                        for (var i = 0; i < files.length; i++) {
                            var fileName = files[i].name;
                            if (files[i].size > this.upload_max_filesize) {
                                isError = true;
                                break;
                            }

                            // Validating Form Size
                            var formSize = 0
                            var formData = new FormData(currentElement.parents('form')[0])

                            for (var pair of formData.entries()) {
                                if (pair[1] instanceof Blob) {
                                    formSize += pair[1].size
                                } else {
                                    formSize += pair[1].length
                                }
                            }

                            if (formSize > this.max_post_size) {
                                isError = true
                            }

                            attachmentBlock.append(this.labelTemplate({
                                'fileName': fileName
                            }));
                        }
                    }
                }

                if (isError) {
                    attachmentBlock.parents('.attachment-block').append(this.getDefaultErrorMessage())
                    attachmentBlock.remove()
                    return
                }

                attachmentBlock.show()
            },
            removeFile: function(e) {
                this.removeError(e);
                let el = $(e.currentTarget).parent('.uv-selected-attachment-item');
                let inputEl = el.siblings('.uv-attachment').find('input');

                let fileCount = $("input[name='attachments[]']")[0].files.length;
                if (fileCount > 1) {
                    console.log(fileCount);
                    let fileName = el.data('name');
                    let files = inputEl[0].files;
                    let dt = new DataTransfer();

                    for (let i = 0; i < files.length; i++) {
                        let file = files[i];
                        if (el.data('name') != files[i].name) {
                            dt.items.add(file);
                        }
                    }

                    $("input[name='attachments[]']")[0].files = dt.files;
                    el.remove();

                    if ($("input[name='attachments[]']")[0].files.length == 0) {
                        $('.uv-added-attachment').remove();
                    }
                }

                Backbone.$(e.currentTarget).parents('.uv-added-attachment').remove();
            },
            getDefaultErrorMessage: function() {
                return '<span class="uv-field-message">You can send up to ' + Math.floor(this.upload_max_filesize/(1024*1024)) + ' MB in attachments. If you have more than one attachment, they can\'t add up to more than ' + Math.floor(this.max_post_size/(1024*1024))  + ' MB and ' + this.max_file_uploads + ' attachments in total.</span>'
            },
            removeError: function(e) {
                Backbone.$(e.currentTarget).parents('.attachment-block').find('.uv-field-message').remove()
            }
        });

        var fileView = new FileView();
    });
</script>

<script src="/public/bundles/uvdeskcoreframework/js/tinymce/tinymce.min.js"></script>
<script src="/public/bundles/uvdeskcoreframework/js/tinymce/themes/modern/theme.min.js"></script>
<script scr="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script type="text/javascript">

    var sfTinyMce = {
        tinymce : tinymce,
        options : {
            browser_spellcheck : true,
            selector: '.uv-view textarea',
            branding: false,
            relative_urls : false,
            remove_script_host : false,
            convert_urls: true,
            image_title: true,
            autoresize_max_height: 350,
            theme: 'modern',
            menubar: false,
            height: 150,
            toolbar: '| undo redo | bold italic forecolor | bullist numlist | link image',
            spellchecker_languages: 'English=en',
            plugins: [
                'spellchecker  autolink lists link charmap print preview hr anchor pagebreak',
                'searchreplace wordcount visualblocks visualchars code fullscreen',
                'media nonbreaking table directionality',
                'emoticons template paste textcolor colorpicker textpattern codesample toc',
                'autoresize image imagetools',
                'mention',
            ],
            invalid_elements : 'script,style,input,textarea,form,onmouseover,onmouseout,onclick',
            // paste_as_text: true,
            paste_data_images: true,
            image_advtab: true,
            mentions : {
                source: function(){
                    return [];
                },
            },
        },
        init : function (options){
            if (typeof(options.setup) === 'function') {
                let optionsSetup = options.setup;
                this.options.setup = function(editor){
                    sfTinyMce.initImageUpload(editor);
                    optionsSetup(editor);
                }
                delete options.setup;
            } else {
                this.options.setup = function(editor){
                    sfTinyMce.initImageUpload(editor);
                }

                delete options.setup;
            }

            this.options = $.extend({}, this.options, options)
            window.tinymce.dom.Event.domLoaded = true;
            tinymce.init(this.options);
        },
        html : function(selector, html){
            tinymce.get(selector).setContent(html);
        },
        initImageUpload : function(editor) {
            // create input and insert in the DOM
            var inp = $('<input id="tinymce-uploader" type="file" name="pic" accept="image/*" style="display:none">');
            $(editor.getElement()).parent().append(inp);

            // add the image upload button to the editor toolbar
            editor.addButton('imageupload', {
                text: '',
                icon: 'image',
                onclick: function(e) { // when toolbar button is clicked, open file select modal
                    inp.trigger('click');
                }
            });

            // when a file is selected, upload it to the server
            inp.on("change", function(e){
                sfTinyMce.uploadFile($(this), editor);
            });
        },
        uploadFile : function(input, editor) {
            sendFile(input.get(0).files).done(function(json){
                    //remove loading image
                    if (json['error'] != '') {
                        var response = {
                            'alertClass' : 'danger',
                            'alertMessage' : json['error'],
                        };
                        app.appView.hideLoader();
                        app.appView.renderResponseAlert(response);
                    } else if (json['fileNames']) {
                        $.each(json['fileNames'], function(key, path){
                            editor.insertContent('<img class="content-img" src="' + path + '"/>');
                        });
                    }
                    if (json.location != undefined)
                        window.location = json.location;
                })
                .fail(function(xhr) {
                    if (url = xhr.getResponseHeader('Location'))
                        window.location = url;

                    app.appView.hideLoader();
                    app.appView.renderResponseAlert(warningResponse);
                })
            ;
        },
    }

    function sendFile(files) {
        var data = new FormData();
        var nonEmptyFlag;
        $.each(files, function(key, file){
            var patt = new RegExp("(image/)(?!tif)");
            if (file.type && patt.test(file.type)) {
                data.append("attachments[]", file);
                nonEmptyFlag = true;
            }
        });
            }

    function sendUrls(url) {
            }

    function removeFile(file) {
            }
    addTranslateButton = function(editor) {
            }
</script>

<script type="text/javascript">
    $(function () {
        if (typeof(customFieldValidation) == 'undefined') {
            customFieldValidation = {};
        }
                    $.each([], function(key, value){
                $('label[for="' + value + '"]').parent().hide();
            });

        $('.uv-header-date').datetimepicker({
            format: 'YYYY-MM-DD',
        });
        $('.uv-header-time').datetimepicker({
            format: 'LT',
        });
        $('.uv-header-datetime').datetimepicker({
            format: 'YYYY-MM-DD H:m:s'
        });

        var CreateTicketModel = Backbone.Model.extend({
            idAttribute : "id",
            defaults : {
                path : "",
            },
            validation: _.extend(customFieldValidation, {
                                    'name' : {
                        required : true,
                        msg : "This field is mandatory"
                    },
                    'from' :
                    [{
                        required : true,
                        msg : "This field is mandatory"
                    },{
                        pattern : /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,
                        msg : "Email address is invalid"
                    }],
                                'type' : {
                    required : true,
                    msg : "This field is mandatory"
                },
                'subject' : {
                    required : true,
                    msg : "This field is mandatory"
                },
                'reply' : {
                    fn: function(value) {
                            if(!tinyMCE.get("uv-edit-create-thread"))
                                return false;
                            var html = tinyMCE.get("uv-edit-create-thread").getContent();
                            if(app.appView.stripHTML(html) != '') {
                                return false;
                            }
                            return true;
                        },
                    msg : "This field is mandatory"
                },
            }),
            urlRoot : "/public/en/member/ticket/save"
        });

        sfTinyMce.init({
            height: '155px',
			selector : '#create-reply',
			images_upload_url: "",
            setup: function(editor) {
            },
			plugins: [
            ],
			toolbar: '| undo redo | bold italic forecolor ',
		});

        var CreateTicketForm = Backbone.View.extend({
            el : $("#create-ticket-modal #create-ticket-form"),
            model: new CreateTicketModel(),
            initialize : function() {
                Backbone.Validation.bind(this);
                var jsonContext = JSON.parse('{}');
                for (var field in jsonContext) {
                    Backbone.Validation.callbacks.invalid(this, field, jsonContext[field], 'input');
                }
            },
            events : {
                'click #create-ticket-btn': "saveTicket",
                'change #type': "updateCustomFields",
                'blur input.create-ticket:not(input[type=file]), textarea.create-ticket, select.create-ticket, checkbox.create-ticket': 'formChanged',
                'change input[type=file].create-ticket': 'formChanged',
            },
            formChanged: function(e) {
                this.model.set(Backbone.$(e.currentTarget).attr('name'), Backbone.$(e.currentTarget).val())
                this.model.isValid([Backbone.$(e.currentTarget).attr('name')])
            },
            saveTicket: function (e) {
                e.preventDefault();
                var currentElement = Backbone.$(e.currentTarget);
                var data = currentElement.closest('form').serializeObject();
                this.model = new CreateTicketModel();
                this.model.set(data);
                Backbone.Validation.bind(this);

                if (this.model.isValid(true)) {
                    $('#create-ticket-form').submit();
                    $('form').find('#create-ticket-btn').attr('disabled', 'disabled');
                }
            },
            updateCustomFields: function (e) {
                const dependentFields = e.currentTarget.value;
                this.$('.dependent').hide();
                this.$('.dependency' + dependentFields).show();
            }
        });

        new CreateTicketForm();
    });
</script>

                <div class="uv-wrapper">
                    <div class="uv-container">
                            <style>
        .workflow-conditions-body .workflow-condition:first-child .uv-workflow-hr-plank {
            display: none;
        }
        .grammarly-fix-message-container {
			overflow: visible !important;
		}
		.grammarly-fix-message {
			max-width: 120%;
		}
        .textarea-fix-action {
            max-width: 500px !important;
        }
    </style>
    <!-- Inner Section -->
    <div class="uv-inner-section">

		    <div class="uv-aside" >
        <div class="uv-aside-head">
            <div class="uv-aside-title"><h6>Productivity</h6></div>
            <div class="uv-aside-back">
                <span onclick="history.length > 1 ? history.go(-1) : window.location = '/public/en/member/dashboard';"> Back</span>
            </div>
        </div>

        <div class="uv-aside-nav">
            <ul>
                                    <li><a href="/public/en/member/prepared-responses" class="">Prepared Responses</a></li>
                                    <li><a href="/public/en/member/saved-replies" class="">Saved Replies</a></li>
                                    <li><a href="/public/en/member/support-tags" class="">Tags</a></li>
                                    <li><a href="/public/en/member/ticket-types" class="">Ticket Types</a></li>
                                    <li><a href="/public/en/member/workflows" class="uv-aside-nav-active">Workflows</a></li>
                            </ul>
        </div>
    </div>


        <!-- View -->
        <div class="uv-view ">
            <!-- Form -->
                            <h1>Edit Workflow</h1>
                <form class="workflow-form" name="form-workflow" method="POST" action="/public/en/member/workflow/edit/5">
                            <!-- Workflow Description Section -->
                <div class="uv-element-block">
                    <label class="uv-field-label">Name</label>
                    <div class="uv-field-block">
                        <input name="name" class="uv-field" type="text" value="Ticket Created">
                        <p class="uv-field-message"></p>
                    </div>
                </div>

                <div class="uv-element-block">
                    <label class="uv-field-label">Description</label>
                    <div class="uv-field-block grammarly-fix-message-container">
                        <textarea name="description" class="uv-field grammarly-fix-message">Automate actions when ticket is created.</textarea>
                        <p class="uv-field-message"></p>
                    </div>
                </div>

                <div class="uv-element-block">
                    <label class="uv-field-label">Workflow status</label>
                    <div class="uv-element-block">
                        <label>
                            <div class="uv-checkbox">
                                <input name="status" type="checkbox" checked>
                                <span class="uv-checkbox-view"></span>
                            </div>
                            <span class="uv-checkbox-label">Workflow is active</span>
                        </label>
                    </div>
                </div>

                <div class="uv-hr"></div>
                <!-- // Workflow Description Section -->


                <!-- Workflow Events Section -->
                <div id="events" class="uv-field-workflow">
                    <label class="uv-field-label">Events</label>
                    <span class="uv-field-info">An event automatically triggers to check conditions and perform a set of pre-defined actions</span>

                    <div class="workflow-event-body"></div>
                    <div class="uv-workflow-buttons">
                        <a class="uv-btn-tag btn-add" href="#">
                            <span class="uv-icon-add-dark"></span> Add More
                        </a>
                    </div>
                </div>

                <div class="uv-hr"></div>
                <!-- // Workflow Events Section -->

                <!-- Workflow Conditions Section -->
                <div id="conditions" class="uv-field-workflow" >
                    <label class="uv-field-label">Conditions</label>
                    <span class="uv-field-info">Conditions are sets of rules which check for specific scenarios.</span>

                    <div class="workflow-conditions-body"></div>
                    <div class="uv-workflow-buttons">
                        <a class="uv-btn-tag btn-or" href="#">
                            <span class="uv-icon-add-dark"></span> OR
                        </a>
                        <a class="uv-btn-tag btn-and" href="#">
                            <span class="uv-icon-add-dark"></span> AND
                        </a>
                    </div>
                </div>
                <!-- // Workflow Conditions Section -->
                <div class="uv-hr"></div>



                <!-- Workflow Actions Section -->
                <div id="actions" class="uv-element-block uv-field-workflow">
                    <label class="uv-field-label">Actions</label>
                    <span class="uv-field-info">Actions help you automate tickets</span>

                    <div class="workflow-action-body"></div>
                    <div class="uv-workflow-buttons">
                        <a class="uv-btn-tag btn-add" href="#">
                            <span class="uv-icon-add-dark"></span> Add More
                        </a>
                    </div>
                </div>
                <!-- // Workflow Actions Section -->


                <!-- CTA -->
                                <button type="submit" name="submit" class="uv-btn" href="#">Save Workflow</button>
                <!-- // CTA -->
            </form>
            <!-- Form -->
        </div>
        <!-- // View -->
    </div>
    <!-- // Inner Section -->
                    </div>
                </div>
            </div>

                        <script>
                // Show loader by default
                document.addEventListener('DOMContentLoaded', function() {
                    // Ensure the loader is visible
                    document.querySelector('.uv-loader-view').style.display = 'block';
                });

                // Hide loader once the page is fully loaded
                window.onload = function() {
                    // Hide the loader
                    document.querySelector('.uv-loader-view').style.display = 'none';
                };
            </script>

            <script src="/public/bundles/uvdeskcoreframework/js/_common.js"></script>
            <script id="pagination_tmp" type="text/template">
    <% if(pageCount > 1) { %>
        <div class="uv-pagination">
            <% if(previous) { %>
                <a data-page="<%= previous %>" href="<%= url.replace('replacePage', previous) %>" id="previous" class="uv-pagination-previous">
                </a>
            <% } else { %>
                <a class="uv-pagination-previous">
                </a>
            <% } %>

            <% if(startPage > 1) { %>
                <a data-page="1" href="<%= url.replace('replacePage', 1) %>">1</a>
                <% if(startPage == 3) { %>
                    <a data-page="2" href="<%= url.replace('replacePage', 2) %>">2</a>
                <% } else if(startPage != 2) { %>
                    <a class="uv-page-active" style="text-decoration: none">&hellip;</a>
                <% } %>
            <% } %>

            <% _.each(pagesInRange, function(page) { %>
                <% if(page != current) { %>
                    <a data-page="<%= page %>" href="<%= url.replace('replacePage', page) %>">
                        <%= page %>
                    </a>
                <% } else { %>
                    <a class="uv-page-active"><%= page %></a>
                <% } %>
            <% }) %>

            <% if(pageCount > endPage) { %>
                <% if(pageCount > (endPage + 1) ) { %>
                    <% if(pageCount > (endPage + 2) ) { %>
                        <a class="uv-page-active" style="text-decoration: none">&hellip;</a>
                    <% } else { %>
                        <a data-page="<%= pageCount - 1 %>" href="<%= url.replace('replacePage', pageCount - 1) %>">
                            <%= pageCount - 1 %>
                        </a>
                    <% } %>
                <% } %>
                <a data-page="<%= pageCount %>" href="<%= url.replace('replacePage', pageCount) %>">
                    <%= pageCount %>
                </a>
            <% } %>

            <% if(next) { %>
                <a href="<%= url.replace('replacePage',next) %>" data-page="<%= next %>" id="next" class="uv-pagination-next">
                </a>
            <% } else { %>
                <a class="uv-pagination-next">
                </a>
            <% } %>
        </div>
    <% } %>
</script>
                        <div class="uv-pop-up-overlay" id="confirm-modal">
                <div class="uv-pop-up-box uv-pop-up-slim">
                    <span class="uv-pop-up-close"></span>
                    <h2>Confirm Action</h2>
                    <p>Are you sure you want to perform this action?</p>

                    <div class="uv-pop-up-actions">
                        <a href="#" class="uv-btn uv-btn-error confirm">Confirm</a>
                        <a href="#" class="uv-btn cancel">Cancel</a>
                    </div>
                </div>
            </div>

                        <script type="text/template" id="loader-tmp">
                <div class="uv-loader">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </script>

                        <script type="text/template" id="full-view-loader">
                <div class="uv-loader-view">
                    <div class="uv-loader">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </script>

                        <script type="text/template" id="notification-template">
                <div class="uv-notification <% if(alertClass == 'danger') { %>uv-error<% } else { %> <%= 'uv-' + alertClass %> <% } %>">
                    <span class="uv-notification-close"></span>
                    <p><%= alertMessage %> </p>
                </div>
            </script>

            <script type="text/javascript">
                var warningResponse = {
                    'alertClass' : 'danger',
                    'alertMessage' : 'Error: Something went wrong, please try again later',
                };
            </script>



    <script type="text/javascript">
        _.extend(Backbone.Validation.patterns, {
          stringPattern: /[a-z0-9]/i,
        });

        _.extend(Backbone.Validation.callbacks, {
            valid : function (view, attr, selector) {
                $('[name="'+attr+'"]').closest('.uv-field-block').find('.uv-field-message').html('').fadeOut(0);
            },
            invalid : function (view, attr, error, selector) {
                $('[name="'+attr+'"]').closest('.uv-field-block').find('.uv-field-message').html(error).fadeIn(0);
            }
        });

        if(typeof(sB) == 'undefined'){
          var sB = {};
        }

        sB.WorkflowCollection = Backbone.Collection.extend({
            baseUrl: "/public/en/member/service-call",
            fetchResult: function(dataMatch) {
            this.url = this.baseUrl;
            return this.fetch({ 'data' : {
                'service': 'email.service',
                'call': 'getEmailPlaceHolders',
                'options': { 'match': dataMatch },
            }});
        }});
        sB.workflowCollection = new sB.WorkflowCollection();

        sB.WorkflowModel = Backbone.Model.extend({
            validation: {
                name: {
                    required: true,
                    pattern: 'stringPattern',
                    msg: "Please enter a valid name."
                },
            },
            validateSelect: function(value, attr, computedState) {
                var currentSelectValue = $('select[name="'+ attr + '"]').find(':selected').length;
                if (!value) {
                    return "Please select a value.";
                }
            },
            validateSelectMultiple: function(value, attr, computedState) {
                var currentSelectValue = $('[name="'+ attr + '"]').length;
                if (!value) {
                    return "Please select a value.";
                }
            },
            validateSelectText: function(value, attr, computedState) {
                if (!value) {
                    return "Please add a value.";
                }
            }
        });

        sB.WorkflowView = Backbone.View.extend({
            el: '.uv-view',
            initialize: function() {
                this.model = new sB.WorkflowModel();
                Backbone.Validation.bind(this);
            },
            events: {
                'submit form[name="form-workflow"]': 'processWorkflow',
            },
            processWorkflow: function(e) {
                var disabledCollection = this.$el.find('form').find('[disabled]');
                if ($(disabledCollection).length > 0) {
                    $.each($(disabledCollection), function(index, nodeElement) {
                        $(nodeElement).removeAttr('disabled');
                    });
                }

                this.model.set(this.$el.find('form').serializeObject());

                var self = this;
                filterArray = ['name'];
                // Populate Filter Array - Events and Actions are required fields

                // Event
                this.$('.wfEvents').each(function(key, value) {
                    filterArray.push($(value).attr('name'));
                    self.model.validation[$(value).attr('name')] = 'validateSelect';
                });
                this.$('.wfEventTriggers').each(function(key, value) {
                    filterArray.push($(value).attr('name'));
                    self.model.validation[$(value).attr('name')] = 'validateSelect';
                });

                // Conditions
                if ($("[name='events[0][event]']").val() == 'ticket' || $("[name='events[0][event]']").val() == 'task') {
                    this.$('.wfCondition').each(function(key, value) {
                        filterArray.push($(value).attr('name'));
                        self.model.validation[$(value).attr('name')] = 'validateSelect';
                    });
                    this.$('.wfConditionMatch').each(function(key, value) {
                        filterArray.push($(value).attr('name'));
                        self.model.validation[$(value).attr('name')] = 'validateSelect';
                    });
                    this.$('.wfConditionValue').each(function(key, value) {
                        if ($(this).attr('name') == undefined) {
                            return;
                        }
                        filterArray.push($(value).attr('name'));
                        self.model.validation[$(value).attr('name')] = 'validateSelectText';
                    });
                }

                // Actions
                this.$('.wfAction').each(function(key, value) {
                    filterArray.push($(value).attr('name'));
                    self.model.validation[$(value).attr('name')] = 'validateSelect';
                });
                this.$('.wfActionMultiple').each(function(key, value) {
                    filterArray.push($(value).attr('name'));
                    self.model.validation[$(value).attr('name')] = 'validateSelectMultiple';
                });
                this.$('.wfActionValue').each(function(key, value) {
                    if ($(this).attr('name') == undefined) {
                        return;
                    }

                    filterArray.push($(value).attr('name'));
                    self.model.validation[$(value).attr('name')] = 'validateSelectText';
                });

                if (this.validateData(filterArray)) {
                    return true;
                } else {
                    e.preventDefault();
                    if ($(disabledCollection).length > 0) {
                        $.each($(disabledCollection), function(index, nodeElement) {
                            $(nodeElement).attr('disabled', 'disabled');
                        });
                    }
                }
            },
            validateData: function(filterArray) {
                return this.model.isValid(filterArray);
            },
            updateActive: function(e){
                this.$('div.step-info').each(function() {
                    $(this).addClass('active');
                    if ($(this).attr('data-href') == self.$(e.target).attr('href'))
                        return false;
                });
            }
        });
        sB.workflowView = new sB.WorkflowView();

        $.fn.serializeObject = function () {
            "use strict";
            var a = {}, b = function (b, c) {
                var d = a[c.name];
                "undefined" != typeof d && d !== null ? $.isArray(d) ? d.push(c.value) : a[c.name] = [d, c.value] : a[c.name] = c.value
            };
            return $.each(this.serializeArray(), b), a
        };
    </script>


<script type="text/template" id="event-add">
	<select class="uv-select uv-select-grouped select-event wfEvents" name="events[<%- keyNo %>][event]" <%- typeof(event) != 'undefined' && event ? "disabled=disabled" : '' %>  style="width: 300px;">
		<option value="">Select an Event</option>
		<% for(var key in events){ %>
			<option value="<%= key %>" <%- typeof(event) != 'undefined' && event == key ? 'selected' : '' %>><%= events[key] %></option>
		<% } %>
	</select>

	<span class="apply-event">
		<a class="uv-btn-tag remove-event-select" href="#"><span class="uv-icon-remove-dark-box"></a>
	</span>

	<p class="uv-field-message" style="display: none;"></p>
</script>

<script type="text/template" id="event-value-select">
	<select class="uv-select uv-select-grouped wfEventTriggers" name="events[<%- keyNo %>][trigger]" style="width: 300px;">
		<% for (var key in triggers) { %>
			<option value="<%= key %>" <%- typeof(trigger) != 'undefined' && trigger == key ? 'selected' : '' %>><%= triggers[key] %></option>
		<% } %>
	</select>
</script>

<script type="text/javascript">
	var workflowAccess = 1;

	if(typeof(sB) == 'undefined'){
		var sB = {};
	}

	sB.eventRow = sB.PrevEvent = 0;
	sB.JsonEvents = JSON.parse("\u007B\u0022user\u0022\u003A\u0022User\u0022,\u0022agent\u0022\u003A\u0022Agent\u0022,\u0022customer\u0022\u003A\u0022Customer\u0022,\u0022ticket\u0022\u003A\u0022Ticket\u0022,\u0022email\u0022\u003A\u0022Email\u0022\u007D");
	sB.MatchEvents = JSON.parse("\u007B\u0022agent\u0022\u003A\u007B\u0022uvdesk.agent.created\u0022\u003A\u0022Agent\u0020Created\u0022,\u0022uvdesk.agent.removed\u0022\u003A\u0022Agent\u0020Deleted\u0022,\u0022uvdesk.user.forgot_password\u0022\u003A\u0022Agent\u0020Forgot\u0020Password\u0022,\u0022uvdesk.agent.update\u0022\u003A\u0022Agent\u0020Update\u0022\u007D,\u0022customer\u0022\u003A\u007B\u0022uvdesk.customer.created\u0022\u003A\u0022Customer\u0020Created\u0022,\u0022uvdesk.customer.removed\u0022\u003A\u0022Customer\u0020Deleted\u0022,\u0022uvdesk.user.forgot_password\u0022\u003A\u0022Customer\u0020Forgot\u0020Password\u0022,\u0022uvdesk.customer.updated\u0022\u003A\u0022Customer\u0020Update\u0022\u007D,\u0022ticket\u0022\u003A\u007B\u0022uvdesk.ticket.agent_updated\u0022\u003A\u0022Agent\u0020Updated\u0022,\u0022uvdesk.ticket.agent_reply\u0022\u003A\u0022Agent\u0020Reply\u0022,\u0022uvdesk.ticket.collaborator_updated\u0022\u003A\u0022Collaborator\u0020Added\u0022,\u0022uvdesk.ticket.collaborator_reply\u0022\u003A\u0022Collaborator\u0020Reply\u0022,\u0022uvdesk.ticket.created\u0022\u003A\u0022Ticket\u0020Created\u0022,\u0022uvdesk.ticket.customer_reply\u0022\u003A\u0022Customer\u0020Reply\u0022,\u0022uvdesk.ticket.removed\u0022\u003A\u0022Ticket\u0020Deleted\u0022,\u0022uvdesk.ticket.group_updated\u0022\u003A\u0022Group\u0020Updated\u0022,\u0022uvdesk.ticket.note_added\u0022\u003A\u0022Note\u0020Added\u0022,\u0022uvdesk.ticket.priority_updated\u0022\u003A\u0022Priority\u0020Updated\u0022,\u0022uvdesk.ticket.status_updated\u0022\u003A\u0022Status\u0020Updated\u0022,\u0022uvdesk.ticket.team_updated\u0022\u003A\u0022Team\u0020Updated\u0022,\u0022uvdesk.ticket.thread_updated\u0022\u003A\u0022Thread\u0020Updated\u0022,\u0022uvdesk.ticket.type_updated\u0022\u003A\u0022Type\u0020Updated\u0022\u007D,\u0022user\u0022\u003A\u007B\u0022uvdesk.user.forgot_password\u0022\u003A\u0022User\u0020Forgot\u0020Password\u0022\u007D,\u0022email\u0022\u003A\u007B\u0022uvdesk.email.received\u0022\u003A\u0022Email\u0020Received\u0022\u007D\u007D");

	sB.EventSelectView = Backbone.View.extend({
		tagName: 'div',
		className: 'uv-field-block workflow-event',
		eventTemplate: _.template($('#event-add').html()),
		valueSelectTemplate: _.template($('#event-value-select').html()),
		events: {
			'change .select-event': 'selectOption',
			'change .apply-event': 'selectValue',
			'click .remove-event-select': 'removeSelect'
		},
		initialize: function() {
			(this.model == undefined || this.model.altKey != undefined) ? this.model = {'event': sB.PrevEvent ? sB.PrevEvent : 0} : false;
			this.keyNo = sB.eventRow;
			sB.eventRow++;
		},
		render: function() {
			this.$el.html(this.eventTemplate(_.extend(this.model, {'keyNo': this.keyNo, 'events': sB.JsonEvents})));
			return this;
		},
		removeSelect: function(e) {
			if ($('.uv-field-block.workflow-event').length > 1) {
				this.remove();
				this.firstEnable();
			} else {
				$(this.el).find('.uv-field-message').html("This field is required").fadeIn(0);
			}
		},
		selectOption: function(e) {
			if (e.target.value != sB.PrevEvent) {
				$('#events').find('.workflow-event').not(this.$el).remove();
				sB.PrevEvent = e.target.value;
				if (typeof(sB.ActionSelectViews) != 'undefined') {
					sB.actionselectView.clearHtml();
				}
				if (typeof(sB.SelectViews) != 'undefined') {
					sB.selectView.clearHtml();
				}
			}

			this.firstEnable();
			var value = sB.PrevEvent = e.target.value;
			this.updateButtonHref(value);
			this.siblingValue = this.$el.find('.apply-event');
			this.siblingValue.find('.uv-select').remove();
			this.siblingValue.prepend(this.valueSelectTemplate(_.extend(this.model, {'triggers' : sB.MatchEvents[value], 'keyNo': this.keyNo})));
		},
		updateButtonHref: function(value) {
			if (value) {
				if (value == 'customer' || value == 'agent') {
					$('#events').find('.btn-next').attr('href', '#actions');
					$('#actions').find('.btn-prev').attr('href', '#events');
				} else {
					$('#events').find('.btn-next').attr('href', '#conditions');
					$('#actions').find('.btn-prev').attr('href', '#conditions');
				}
			}
		},
		firstEnable: function() {
			if (workflowAccess) {
				$('#events').find('.workflow-event').eq(0).find('.uv-select.wfEvents').attr('disabled', false);
			}
		},
		selectValue: function(e) {
			sB.eventselectView.removeduplicate(e);
			this.firstEnable();
		}
	});

	sB.EventSelectViews = Backbone.View.extend({
		el: '.uv-view',
		target: $('#events .workflow-event-body'),
		initialize: function(){
							this.createEvents($.parseJSON("\u005B\u007B\u0022event\u0022\u003A\u0022ticket\u0022,\u0022trigger\u0022\u003A\u0022uvdesk.ticket.created\u0022\u007D\u005D"));
					},
		events: {
			'click #events .btn-add': 'addSelect',
		},
		createEvents: function(eventPreviouslyAdded) {
			_.each(eventPreviouslyAdded, this.addSelect, this);
		},
		addSelect: function(eventModel) {
			var view = new sB.EventSelectView({model: eventModel});
	        this.target.append(viewEl = view.render().el);
	        // if (typeof(eventModel.type) == 'undefined' && typeof(eventModel.trigger) != 'undefined')
	        	this.$(viewEl).find('select.wfEvents').trigger('change');
		},
		removeduplicate: function(e) {
			// remove already exits elements - select
		    $('.apply-event select').each(function() {
				if (this.value == e.target.value) {
					$(this).not(e.target).parents('tr').remove();
				}
		    })
		},
	});

	sB.eventselectView = new sB.EventSelectViews();
</script>
    <script type="text/template" id="select-add">
	<% if (typeof(operation) != 'undefined' && operation == '||') { %>
		<div class="uv-workflow-hr-plank">
	        <div class="uv-workflow-hr-or">
	            <span class="uv-workflow-or">or</span>
	        </div>
	    </div>
		<input type="hidden" name="conditions[<%- keyNo %>][operation]" value="||">
	<% } else if (typeof(operation) != 'undefined' && operation == '&&') { %>
		<div class="uv-workflow-hr-plank">
	        <div class="uv-workflow-hr-and">
	            <span class="uv-workflow-and">and</span>
	        </div>
		</div>
		<input type="hidden" name="conditions[<%- keyNo %>][operation]" value="&&">
	<% } %>

	<select class="uv-select uv-select-grouped select-condition wfCondition" name="conditions[<%- keyNo %>][type]" style="width: 200px;">
		<option value="">Select a Condition</option>
		<% for(var key in conditions) { %>
			<optgroup label="<%-key%>">
				<% for (var key2 in conditions[key]) { %>
					<option value="<%-conditions[key][key2].value%>" data-match="<%-conditions[key][key2].match%>" <%- typeof(type) != 'undefined' && type == conditions[key][key2].value ? 'selected' : ''%>><%- conditions[key][key2].lable %></option>
				<% } %>
			</optgroup>
		<% } %>
	</select>

	<span class="select-match">
    </span>

    <span class="values" style="display: inline-block;">
		<a class="uv-btn-tag remove-tr" href="#"><span class="uv-icon-remove-dark-box"></a>
	</span>
	<p class="uv-field-message" style="display: none;"></p>
</script>

<script type="text/template" id="match-add">
	<select class="uv-select uv-select-grouped wfConditionMatch" name="conditions[<%- keyNo %>][match]" style="width: 200px;">
		<% for(var key in matchArray){ %>
			<option value="<%= matchArray[key].value %>" <%- typeof(match) != 'undefined' && match == matchArray[key].value ? 'selected' : ''%>><%= matchArray[key].lable %></option>
		<% } %>
	</select>
</script>

<script type="text/template" id="value-text">
	<% if (typeof(addDate) != 'undefined' && addDate) { %>
		<span class="date value-container">
	        <input name="conditions[<%- keyNo %>][value]" type="text" class="uv-field form-control uv-date-picker date wfConditionValue" data-date-format="<%- fieldType == 'time' ? 'LT' : (fieldType == 'datetime' ? 'YYYY-MM-DD H:m:s' : 'YYYY-MM-DD') %>" value="<%- typeof(value) != 'undefined' ? value : '' %>" style="width: 200px;">
	        <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span>
	    </span>
	<% } else { %>
		<span class="value-container">
			<input type="text" name="conditions[<%- keyNo %>][value]" class="uv-field wfConditionValue" value="<%- typeof(value) != 'undefined' ? value : ''%>" style="width: 200px;" />
		</span>
	<% } %>
</script>

<script type="text/template" id="value-select">
	<select class="uv-select uv-select-grouped select-value wfConditionValue" name="conditions[<%- keyNo %>][value]" style="width: 200px;">
		<option>Loading...</option>
	</select>
</script>

<script type="text/template" id="value-select-option">
	<option value="<%= id %>" <%- typeof(value) != 'undefined' && value == id ? 'selected' : ''%>><%= name %></option>
</script>

<script type="text/javascript">
	if (typeof(sB) == 'undefined') {
		var sB = {};
	}

	sB.conditionRow = 0;
	sB.JsonConditions = JSON.parse("\u007B\u0022ticket\u0022\u003A\u007B\u0022mail\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022From\u0020Email\u0022,\u0022value\u0022\u003A\u0022from_mail\u0022,\u0022match\u0022\u003A\u0022email\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022To\u0020Email\u0022,\u0022value\u0022\u003A\u0022to_mail\u0022,\u0022match\u0022\u003A\u0022email\u0022\u007D\u005D,\u0022ticket\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Subject\u0022,\u0022value\u0022\u003A\u0022subject\u0022,\u0022match\u0022\u003A\u0022string\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Description\u0022,\u0022value\u0022\u003A\u0022description\u0022,\u0022match\u0022\u003A\u0022string\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Subject\u0020or\u0020description\u0022,\u0022value\u0022\u003A\u0022subject_or_description\u0022,\u0022match\u0022\u003A\u0022string\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Priority\u0022,\u0022value\u0022\u003A\u0022TicketPriority\u0022,\u0022match\u0022\u003A\u0022select\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Type\u0022,\u0022value\u0022\u003A\u0022TicketType\u0022,\u0022match\u0022\u003A\u0022select\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Status\u0022,\u0022value\u0022\u003A\u0022TicketStatus\u0022,\u0022match\u0022\u003A\u0022select\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Source\u0022,\u0022value\u0022\u003A\u0022source\u0022,\u0022match\u0022\u003A\u0022select\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Created\u0022,\u0022value\u0022\u003A\u0022created\u0022,\u0022match\u0022\u003A\u0022date\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Agent\u0022,\u0022value\u0022\u003A\u0022agent\u0022,\u0022match\u0022\u003A\u0022select\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Group\u0022,\u0022value\u0022\u003A\u0022group\u0022,\u0022match\u0022\u003A\u0022select\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Team\u0022,\u0022value\u0022\u003A\u0022team\u0022,\u0022match\u0022\u003A\u0022select\u0022\u007D\u005D,\u0022customer\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Customer\u0020Name\u0022,\u0022value\u0022\u003A\u0022customer_name\u0022,\u0022match\u0022\u003A\u0022string\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Customer\u0020Email\u0022,\u0022value\u0022\u003A\u0022customer_email\u0022,\u0022match\u0022\u003A\u0022email\u0022\u007D\u005D\u007D,\u0022email\u0022\u003A\u007B\u0022mail\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022From\u0020Email\u0022,\u0022value\u0022\u003A\u0022from_mail\u0022,\u0022match\u0022\u003A\u0022email\u0022\u007D\u005D\u007D\u007D");
	sB.MatchConditions = JSON.parse("\u007B\u0022email\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Is\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022is\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Is\u0020Not\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022isNot\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Contains\u0022,\u0022value\u0022\u003A\u0022contains\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Does\u0020Not\u0020Contain\u0022,\u0022value\u0022\u003A\u0022notContains\u0022\u007D\u005D,\u0022string\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Is\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022is\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Is\u0020Not\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022isNot\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Contains\u0022,\u0022value\u0022\u003A\u0022contains\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Does\u0020Not\u0020Contain\u0022,\u0022value\u0022\u003A\u0022notContains\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Starts\u0020With\u0022,\u0022value\u0022\u003A\u0022startWith\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Ends\u0020With\u0022,\u0022value\u0022\u003A\u0022endWith\u0022\u007D\u005D,\u0022select\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Is\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022is\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Is\u0020Not\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022isNot\u0022\u007D\u005D,\u0022date\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Before\u0022,\u0022value\u0022\u003A\u0022before\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Before\u0020On\u0022,\u0022value\u0022\u003A\u0022beforeOn\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022After\u0022,\u0022value\u0022\u003A\u0022after\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022After\u0020On\u0022,\u0022value\u0022\u003A\u0022afterOn\u0022\u007D\u005D,\u0022datetime\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Before\u0022,\u0022value\u0022\u003A\u0022beforeDateTime\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Before\u0020On\u0022,\u0022value\u0022\u003A\u0022beforeDateTimeOn\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022After\u0022,\u0022value\u0022\u003A\u0022afterDateTime\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022After\u0020On\u0022,\u0022value\u0022\u003A\u0022afterDateTimeOn\u0022\u007D\u005D,\u0022time\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Before\u0022,\u0022value\u0022\u003A\u0022beforeTime\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Before\u0020On\u0022,\u0022value\u0022\u003A\u0022beforeTimeOn\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022After\u0022,\u0022value\u0022\u003A\u0022afterTime\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022After\u0020On\u0022,\u0022value\u0022\u003A\u0022afterTimeOn\u0022\u007D\u005D,\u0022number\u0022\u003A\u005B\u007B\u0022lable\u0022\u003A\u0022Is\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022is\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Is\u0020Not\u0020Equal\u0020To\u0022,\u0022value\u0022\u003A\u0022isNot\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Contains\u0022,\u0022value\u0022\u003A\u0022contains\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Greater\u0020Than\u0022,\u0022value\u0022\u003A\u0022greaterThan\u0022\u007D,\u007B\u0022lable\u0022\u003A\u0022Less\u0020Than\u0022,\u0022value\u0022\u003A\u0022lessThan\u0022\u007D\u005D\u007D");

	sB.Collection = Backbone.Collection.extend({
	    baseUrl: "/public/en/member/workflow/xhr/condition/options",
		fetchResult: function(dataMatch) {
			this.url = this.baseUrl + '/' + dataMatch;
	        return this.fetch();
		},
	});

	sB.SelectView = Backbone.View.extend({
		tagName: 'div',
		className: 'uv-field-block workflow-condition',
		selectTemplate: _.template($('#select-add').html()),
		matchTemplate: _.template($('#match-add').html()),
		valueTextTemplate: _.template($('#value-text').html()),
		valueSelectTemplate: _.template($('#value-select').html()),
		valueSelectOptionTemplate: _.template($('#value-select-option').html()),
		events: {
			'change .select-condition': 'selectMatch',
			'click .remove-tr': 'removeTr'
		},
		initialize: function() {
			this.disable = false;
			this.keyNo = sB.conditionRow;
			sB.conditionRow++;
		},
		render: function() {
			var objKey = ((typeof(sB.PrevEvent) != 'undefined' && sB.PrevEvent) ? sB.PrevEvent : 'ticket');
			this.$el.html(this.selectTemplate(_.extend(this.model, {'keyNo': this.keyNo, 'conditions': sB.JsonConditions[objKey]})));

			if (objKey == 'ticket' || objKey == 'task' || objKey == 'email') {
				$('#conditions').prev('.uv-hr').fadeIn(10);
				$('#conditions').fadeIn(10);
			} else {
				$('#conditions').prev('.uv-hr').fadeOut(10);
				$('#conditions').fadeOut(10);
				this.$el.empty();
			}

			return this;
		},
		removeTr: function(e) {
			this.remove();
	 		sB.selectView.clearFirstTrSpan();
		},
		selectMatch: function(e) {
			if (this.disable) {
				return;
			}

			var dataMatch = $(e.target).find('option').eq(e.target.selectedIndex).attr('data-match');
			this.selectOpt = this.$el.find('.wfCondition');
			this.siblingMatch = this.$el.find('.select-match');
			this.siblingValue = this.$el.find('.values');
			this.siblingMatch.find('.uv-select').remove();
			this.siblingMatch.prepend(this.matchTemplate(_.extend(this.model, {'matchArray' : sB.MatchConditions[dataMatch], 'keyNo': this.keyNo})));
			this.siblingValue.find('.value-container, .uv-select, .form-group, .form-control, .input-group.date').remove();
			if (dataMatch == 'string' || dataMatch == 'email' || dataMatch == 'number') {
				this.siblingValue.prepend(this.valueTextTemplate(_.extend(this.model, {'addDate' : false, 'keyNo': this.keyNo})));
			} else if (dataMatch == 'date' || dataMatch == 'datetime' || dataMatch == 'time') {
				this.siblingValue.prepend(this.valueTextTemplate(_.extend(this.model, {'addDate' : true, 'fieldType': dataMatch, 'keyNo': this.keyNo})));
				this.datePicker();
			} else if (dataMatch == 'select') {
				this.selectOpt.prop('disabled', true);
				this.disable = true;
				this.siblingValue.prepend(this.valueSelectTemplate(_.extend(this.model, {'keyNo': this.keyNo})));
				var self = this;
				sB.collection.fetchResult(e.target.value)
					.done(function(){
						$(self.el).find('.select-value').find('option').remove();
						self.addAll();
			        })
			        .fail(function(xhr) {
		                if(url = xhr.getResponseHeader('Location'))
		                    window.location = url;
		            });
			}
		},
		addAll: function() {
			_.each(sB.collection.models, this.addOne, this);
			this.disable = false;
			this.selectOpt.prop('disabled', false);
		},
		addOne: function(newModel) {
			this.siblingValue.find('.select-value').append(this.valueSelectOptionTemplate(_.extend(this.model, newModel.attributes)));
		},
		datePicker: function() {
			$('#conditions .date, #conditions .datetime, #conditions .time').datetimepicker();
		}
	});

	sB.SelectViews = Backbone.View.extend({
		el: '.uv-view',
		target: $('#conditions .workflow-conditions-body'),
		initialize: function() {
							var eventData = $.parseJSON("\u005B\u007B\u0022event\u0022\u003A\u0022ticket\u0022,\u0022trigger\u0022\u003A\u0022uvdesk.ticket.created\u0022\u007D\u005D");
						if (eventData.length > 0) {
				if (eventData[0].event == 'ticket' || eventData[0].event == 'task') {
					$('#conditions').prev('.uv-hr').fadeIn(10);
					$('#conditions').fadeIn(10);
				}
			}
							this.createConditions($.parseJSON("\u005B\u005D"));

	 		this.clearFirstTrSpan();
	        // this.listenTo(sB.collection, 'add', this.addOne);
		},
		events: {
			'click .btn-and': 'addSelectAnd',
			'click .btn-or': 'addSelectOr',
		},
		createConditions: function(conditionPreviouslyAdded) {
			_.each(conditionPreviouslyAdded, this.addSelect, this);
		},
		addSelectAnd: function(e) {
			this.model = {'operation' : '&&'};
			this.addSelect(this.model);
		},
		addSelectOr: function(e) {
			this.model = {'operation' : '||'};
			this.addSelect(this.model);
		},
		addSelect: function(newModel) {
			var view = new sB.SelectView({model: newModel});
	        this.target.append(viewEl = view.render().el);
	        this.$(viewEl).find('.wfCondition').trigger('change');
		},
		clearHtml: function() {
	        this.target.html('');
			this.model = {'operation' : '&&'};
			this.addSelect(this.model);
	 		this.clearFirstTrSpan();
		},
		clearFirstTrSpan: function() {
	 		var target = this.target.find('tr').eq(0);
	 		target.find('.uv-workflow-and, input[type="hidden"]').remove();
	 		target.find('.uv-workflow-hr-or').html('');
		},
		datePicker: function() {
			$('.date').datetimepicker({
	            format: 'YYYY-MM-DD',
			});
		}
	});

	sB.collection = new sB.Collection();
	sB.selectView = new sB.SelectViews();
	sB.selectView.datePicker();
</script>

    <script type="text/template" id="action-add">
	<select class="uv-select uv-select-grouped select-action wfAction" name="actions[<%- keyNo %>][type]" style="width: 200px;">
		<option value="">Select an action</option>
		<% for(var key in actions){ %>
			<option value="<%- key %>" <%- typeof(type) != 'undefined' && type == key ? 'selected' : ''%>><%- actions[key] %></option>
		<% } %>
	</select>
	<span class="apply-action" style="display: inline-block; vertical-align: middle;">
		<a class="uv-btn-tag remove-action-tr" href="#"><span class="uv-icon-remove-dark-box"></a>
	</span>
	<p class="uv-field-message" style="display: none;"></p>
</script>

<script type="text/template" id="action-value-text">
	<textarea name="actions[<%- keyNo %>][value]" id="textarea-note" class="uv-field wfActionValue textarea-fix-action" style="width: 200px;"><%- (typeof(value) != 'undefined' && typeof(value) != 'object') ? value : ''%></textarea>
</script>

<script type="text/template" id="action-value-select">
	<select name="actions[<%- keyNo %>][value]" class="uv-select uv-select-grouped action-value wfAction" style="width: 200px;"><option>Loading...</option></select>
</script>

<script type="text/template" id="action-value-multi-select">
	<div class="uv-dropdown asset-visibility action-value-for wfActionMultiple" name="actions[<%- keyNo %>][value][for][]">
		<div class="uv-dropdown-btn uv-vertical-align uv-margin-right-5" style="width: 200px;">Select Option</div>
		<div class="uv-dropdown-list uv-bottom-left">
			<div class="uv-dropdown-container">
				<ul></ul>
			</div>
		</div>
	</div>
	<select name="actions[<%- keyNo %>][value][value]" class="uv-select uv-select-grouped action-value wfAction" style="width: 200px;"><option>Loading...</option></select>
</script>

<script type="text/template" id="action-value-select-multiple">
	<select name="actions[<%- keyNo %>][value][]" class="uv-select uv-select-grouped action-value wfAction" multiple="true" style="width: 200px;"><option>Loading...</option></select>
</script>

<script type="text/template" id="action-value-select-option">
	<option value="<%= id %>" <%- (typeof(value) != 'undefined' && (typeof(value) === 'object' && value.indexOf(id.toString()) > -1)) ? 'selected' : (typeof(value) != 'undefined' && value == id ? 'selected' : '')%>>
	<% if (name == "Low") { %>
		Low
	<% } else if (name == "Medium") { %>
		Medium
	<%} else if (name == "High") { %>
		High
	<% } else if (name == "Urgent") { %>
		Urgent
	<% } else if (name == "Open") { %>
		Open
	<% } else if (name == "Pending") { %>
		Pending
	<%} else if (name == "Answered") { %>
	 	Answered
	<% } else if (name == "Closed") { %>
		Closed
	<%} else if (name == "Resolved") { %>
		Resolved
	<% } else { %>
		<%= name %>
	<% } %></option>
</script>

<script type="text/template" id="action-value-select-for-option">
	<li class="uv-dropdown-checkbox">
        <label>
            <div class="uv-checkbox">
                <input type="checkbox" id="actions[<%- keyNo %>][value][for][<%- id.toString() %>]" name="actions[<%- keyNo %>][value][for][]" value="<%= id %>" <%- (typeof(value) != 'undefined' && (typeof(value) === 'object' && value.indexOf(id.toString()) > -1)) ? 'checked' : (typeof(value) != 'undefined' && value == id ? 'checked' : '')%> >
                <span class="uv-checkbox-view uv-checkbox-dwn"></span>
            </div>
        </label>
        <label for="actions[<%- keyNo %>][value][for][<%- id.toString() %>]" style="display: inline;"><%= name %></label>
    </li>
</script>

<script type="text/javascript">
	$('body').on('focusout', '#textarea-note', function(){
		selection = this;
		oldContent = selection.value;
		cursorPosition = $(this).prop("selectionStart");
		forEditor = false;
		forSubject = true;
	});
	var sB = sB || {};
	sB.actionRow = 0;
	sB.JsonActions = JSON.parse("\u007B\u0022agent\u0022\u003A\u007B\u0022uvdesk.agent.mail_agent\u0022\u003A\u0022Mail\u0020to\u0020agent\u0022,\u0022uvdesk.agent.transfer_tickets\u0022\u003A\u0022Transfer\u0020Tickets\u0022\u007D,\u0022customer\u0022\u003A\u007B\u0022uvdesk.customer.mail_customer\u0022\u003A\u0022Mail\u0020to\u0020customer\u0022\u007D,\u0022ticket\u0022\u003A\u007B\u0022uvdesk.agent.add_note\u0022\u003A\u0022Add\u0020note\u0022,\u0022uvdesk.ticket.mail_agent\u0022\u003A\u0022Mail\u0020to\u0020agent\u0022,\u0022uvdesk.ticket.mail_customer\u0022\u003A\u0022Mail\u0020to\u0020customer\u0022,\u0022uvdesk.ticket.mail_group\u0022\u003A\u0022Mail\u0020to\u0020group\u0022,\u0022uvdesk.ticket.mail_last_collaborator\u0022\u003A\u0022Mail\u0020to\u0020last\u0020collaborator\u0022,\u0022uvdesk.ticket.mail_team\u0022\u003A\u0022Mail\u0020to\u0020team\u0022,\u0022uvdesk.ticket.mark_spam\u0022\u003A\u0022Mark\u0020spam\u0022,\u0022uvdesk.ticket.round_robin_ticket_assignment\u0022\u003A\u0022Round\u0020robin\u0020ticket\u0020assignment\u0022,\u0022uvdesk.ticket.assign_agent\u0022\u003A\u0022Assign\u0020to\u0020agent\u0022,\u0022uvdesk.ticket.assign_group\u0022\u003A\u0022Assign\u0020to\u0020group\u0022,\u0022uvdesk.ticket.update_label\u0022\u003A\u0022Set\u0020Label\u0020As\u0022,\u0022uvdesk.ticket.update_priority\u0022\u003A\u0022Set\u0020Priority\u0020As\u0022,\u0022uvdesk.ticket.update_status\u0022\u003A\u0022Set\u0020Status\u0020As\u0022,\u0022uvdesk.ticket.update_tag\u0022\u003A\u0022Set\u0020Tag\u0020As\u0022,\u0022uvdesk.ticket.assign_team\u0022\u003A\u0022Assign\u0020to\u0020team\u0022,\u0022uvdesk.ticket.update_type\u0022\u003A\u0022Set\u0020Type\u0020As\u0022\u007D,\u0022user\u0022\u003A\u007B\u0022uvdesk.user.mail_user\u0022\u003A\u0022Mail\u0020to\u0020User\u0022\u007D,\u0022email\u0022\u003A\u007B\u0022uvdesk.email.use_address\u0022\u003A\u0022From\u0020Email\u0022\u007D\u007D");
	sB.ActionCollection = Backbone.Collection.extend({
	    baseUrl: "/public/en/member/workflow/xhr/action/options",
		fetchResult: function(dataMatch, currentEvent) {
			this.url = this.baseUrl+'/'+dataMatch + (currentEvent ? ('/' + currentEvent) : '');
			this.reset();

			return this.fetch();
		},
	});
	sB.ActionSelectView = Backbone.View.extend({
		tagName: 'div',
		className: 'uv-field-block workflow-action',
		actionTemplate: _.template($('#action-add').html()),
		valueTextTemplate: _.template($('#action-value-text').html()),
		valueSelectTemplate: _.template($('#action-value-select').html()),
		valueMultiSelectTemplate: _.template($('#action-value-multi-select').html()),
		valueSelectMultipleTemplate: _.template($('#action-value-select-multiple').html()),
		valueSelectOptionTemplate: _.template($('#action-value-select-option').html()),
		valueSelectForOptionTemplate: _.template($('#action-value-select-for-option').html()),
		events: {
			'change .select-action': 'selectOption',
			'click .remove-action-tr': 'removeTr'
		},
		initialize: function() {
			this.keyNo = sB.actionRow;
			sB.actionRow++;
		},
		render: function() {
			this.$el.html(this.actionTemplate(_.extend(this.model, {'keyNo': this.keyNo, 'actions' : sB.JsonActions[(typeof(sB.PrevEvent) != 'undefined' && sB.PrevEvent) ? sB.PrevEvent : 'ticket']})));
			return this;
		},
		removeTr: function(e) {
	 		if ($('.uv-field-block.workflow-action').length > 1) {
				this.remove();
		 		sB.actionselectView.clearFirstTrSpan();
			} else {
				$(this.el).find('.uv-field-message').html("This field is required").fadeIn(0);
			}
		},
		selectOption: function(e) {
			if (this.disable) {
				return;
			}
			var value = this.value = e.target.value;
			if (typeof(sB.actionselectView) != 'undefined') {
				sB.actionselectView.removeDuplicate(e);
			}
			this.selectOpt = this.$el.find('.wfAction');
			this.siblingValue = this.$el.find('.apply-action');
			// if(value == 'delete_ticket' || value == 'mark_spam')
			this.siblingValue.find('select, textarea, div').remove();
			if (value == 'uvdesk.agent.add_note' || value == 'reply') {
				this.siblingValue.prepend(this.valueTextTemplate(_.extend(this.model, {'keyNo': this.keyNo})));
			} else if (value != 'uvdesk.ticket.delete' && value != 'uvdesk.ticket.mark_spam' && value != 'uvdesk.ticket.round_robin_ticket_assignment' && value) {
				this.selectOpt.prop('disabled', true);
				this.disable = true;
				if (value == 'cc' || value == 'bcc') {
					this.siblingValue.prepend(this.valueSelectMultipleTemplate(_.extend(this.model, {'keyNo': this.keyNo})));
				} else if (this.value == 'uvdesk.ticket.mail_group' || this.value == 'uvdesk.ticket.mail_team' || this.value == "uvdesk.ticket.mail_agent") {
					this.siblingValue.prepend(this.valueMultiSelectTemplate(_.extend(this.model, {'keyNo': this.keyNo})));
				} else {
					this.siblingValue.prepend(this.valueSelectTemplate(_.extend(this.model, {'keyNo': this.keyNo})));
				}
				var self = this;
				sB.actionCollection.fetchResult(value, this.getCurrentEvent())
					.done(function() {
						$(self.el).find('.action-value').find('option').remove();
						self.addAll();
		        	})
		        	.fail(function(xhr) {
		                if(url = xhr.getResponseHeader('Location'))
		                    window.location = url;
		            });
			}
		},
		getCurrentEvent: function() {
			return ($('.wfEvents').eq(0).val() ? $('.wfEvents').eq(0).val() : 'ticket');
		},
		addAll: function() {
			if (this.value == 'uvdesk.ticket.mail_group' || this.value == 'uvdesk.ticket.mail_team' || this.value == "uvdesk.ticket.mail_agent")
				_.each(sB.actionCollection.models, this.addOneMore, this);
			else
				_.each(sB.actionCollection.models, this.addOne, this);
			this.disable = false;
			this.selectOpt.prop('disabled', false);
		},
		addOne: function(newModel) {
			if (typeof(this.model.value) == 'object')
				this.model.value = undefined;
			var sendThisModel = _.extend(this.model, newModel.attributes);
			if (typeof(newModel.attributes.id) != 'undefined')
				this.siblingValue.find('.action-value').append(this.valueSelectOptionTemplate(sendThisModel));
		},
		addOneMore: function(models) {
			_.each(models.attributes.partResults, function(newModel){
				this.siblingValue.find('.action-value-for').find('.uv-dropdown-container ul').append(this.valueSelectForOptionTemplate(_.extend({ 'value' : (typeof(this.model.value) != 'undefined' ? this.model.value.for : ''), 'keyNo': this.keyNo}, newModel)));
			}, this);
			_.each(models.attributes.templates, function(newModel){
				this.siblingValue.find('.action-value').append(this.valueSelectOptionTemplate(_.extend({ 'value' : (typeof(this.model.value) != 'undefined' ? this.model.value.value : '')}, newModel)));
			}, this);
		}
	});
	sB.ActionSelectViews = Backbone.View.extend({
		el: '.uv-view',
		target: $('#actions .workflow-action-body'),
		initialize: function() {
							this.createActions($.parseJSON("\u005B\u007B\u0022type\u0022\u003A\u0022uvdesk.ticket.mail_customer\u0022,\u0022value\u0022\u003A\u00227\u0022\u007D,\u007B\u0022type\u0022\u003A\u0022uvdesk.ticket.assign_agent\u0022,\u0022value\u0022\u003A\u0022responsePerforming\u0022\u007D,\u007B\u0022type\u0022\u003A\u0022uvdesk.ticket.mail_agent\u0022,\u0022value\u0022\u003A\u007B\u0022for\u0022\u003A\u005B\u0022assignedAgent\u0022,\u00225\u0022\u005D,\u0022value\u0022\u003A\u00223\u0022\u007D\u007D\u005D"));
				        this.listenTo(sB.actionCollection, 'add', this.addOne);
					},
		events: {
			'click #actions .btn-add': 'addSelect',
		},
		clearHtml: function() {
	        this.target.html('');
			this.addSelect({});
		},
		createActions: function(actionPreviouslyAdded) {
			_.each(actionPreviouslyAdded, this.addSelect, this);
		},
		addSelect: function(newModel) {
			var view = new sB.ActionSelectView({model: newModel});
	        this.target.append(viewEl = view.render().el);
	        this.$(viewEl).find('.wfAction').trigger('change');
	 		this.clearFirstTrSpan();
		},
		removeDuplicate: function(e) {
			//remove already exits elements - select
		    $('.select-action').each(function() {
				if (this.value == e.target.value)
					$(this).not(e.target).parents('tr').remove();
		    });
	 		this.clearFirstTrSpan();
		},
		clearFirstTrSpan: function() {
	 		this.target.find('tr').eq(0).find('span.border-override').remove();
		},
	});
	sB.actionCollection = new sB.ActionCollection();
	sB.actionselectView = new sB.ActionSelectViews();
</script>



<div id="sfwdtda679e" class="sf-toolbar sf-display-none" role="region" aria-label="Symfony Web Debug Toolbar">    <!-- START of Symfony Web Debug Toolbar --><div id="sfMiniToolbar-da679e" class="sf-minitoolbar" data-no-turbolink data-turbo="false">    <button type="button" title="Show Symfony toolbar" id="sfToolbarMiniToggler-da679e" accesskey="D" aria-expanded="false" aria-controls="sfToolbarMainContent-da679e">        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#AAA" d="M12 .9C5.8.9.9 5.8.9 12a11 11 0 1 0 22.2 0A11 11 0 0 0 12 .9zm6.5 6c-.6 0-.9-.3-.9-.8 0-.2 0-.4.2-.6l.2-.4c0-.3-.5-.4-.6-.4-1.8.1-2.3 2.5-2.7 4.4l-.2 1c1 .2 1.8 0 2.2-.3.6-.4-.2-.7-.1-1.2.1-.3.5-.5.7-.6.5 0 .7.5.7.9 0 .7-1 1.8-3 1.8l-.6-.1-.6 2.4c-.4 1.6-.8 3.8-2.4 5.7-1.4 1.7-2.9 1.9-3.5 1.9-1.2 0-1.9-.6-2-1.5 0-.8.7-1.3 1.2-1.3.6 0 1.1.5 1.1 1s-.2.6-.4.6c-.1.1-.3.2-.3.4 0 .1.1.3.4.3.5 0 .8-.3 1.1-.5 1.2-.9 1.6-2.7 2.2-5.7l.1-.7.7-3.2c-.8-.6-1.3-1.4-2.4-1.7-.6-.1-1.1.1-1.5.5-.4.5-.2 1.1.2 1.5l.7.6c.7.8 1.2 1.6 1 2.5-.3 1.5-2 2.6-4 1.9-1.8-.6-2-1.8-1.8-2.5.2-.6.6-.7 1.1-.6.5.2.6.7.6 1.2l-.1.3c-.2.1-.3.3-.3.4-.1.4.4.6.7.7.7.3 1.6-.2 1.8-.8a1 1 0 0 0-.4-1.1l-.7-.8c-.4-.4-1.1-1.4-.7-2.6.1-.5.4-.9.7-1.3a4 4 0 0 1 2.8-.6c1.2.4 1.8 1.1 2.6 1.8.5-1.2 1-2.4 1.8-3.5.9-.9 1.9-1.6 3.1-1.7 1.3.2 2.2.7 2.2 1.6 0 .4-.2 1.1-.9 1.1z"/></svg>    </button></div><div id="sfToolbarClearer-da679e" class="sf-toolbar-clearer"></div><div id="sfToolbarMainContent-da679e" class="sf-toolbarreset clear-fix" data-no-turbolink data-turbo="false">                                                    <div class="sf-toolbar-block sf-toolbar-block-request sf-toolbar-status-normal " >    <a href="http://localhost:8888/public/_profiler/da679e?panel=request">        <div class="sf-toolbar-icon">        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#AAA" d="M12 .9C5.8.9.9 5.8.9 12a11 11 0 1 0 22.2 0A11 11 0 0 0 12 .9zm6.5 6c-.6 0-.9-.3-.9-.8 0-.2 0-.4.2-.6l.2-.4c0-.3-.5-.4-.6-.4-1.8.1-2.3 2.5-2.7 4.4l-.2 1c1 .2 1.8 0 2.2-.3.6-.4-.2-.7-.1-1.2.1-.3.5-.5.7-.6.5 0 .7.5.7.9 0 .7-1 1.8-3 1.8l-.6-.1-.6 2.4c-.4 1.6-.8 3.8-2.4 5.7-1.4 1.7-2.9 1.9-3.5 1.9-1.2 0-1.9-.6-2-1.5 0-.8.7-1.3 1.2-1.3.6 0 1.1.5 1.1 1s-.2.6-.4.6c-.1.1-.3.2-.3.4 0 .1.1.3.4.3.5 0 .8-.3 1.1-.5 1.2-.9 1.6-2.7 2.2-5.7l.1-.7.7-3.2c-.8-.6-1.3-1.4-2.4-1.7-.6-.1-1.1.1-1.5.5-.4.5-.2 1.1.2 1.5l.7.6c.7.8 1.2 1.6 1 2.5-.3 1.5-2 2.6-4 1.9-1.8-.6-2-1.8-1.8-2.5.2-.6.6-.7 1.1-.6.5.2.6.7.6 1.2l-.1.3c-.2.1-.3.3-.3.4-.1.4.4.6.7.7.7.3 1.6-.2 1.8-.8a1 1 0 0 0-.4-1.1l-.7-.8c-.4-.4-1.1-1.4-.7-2.6.1-.5.4-.9.7-1.3a4 4 0 0 1 2.8-.6c1.2.4 1.8 1.1 2.6 1.8.5-1.2 1-2.4 1.8-3.5.9-.9 1.9-1.6 3.1-1.7 1.3.2 2.2.7 2.2 1.6 0 .4-.2 1.1-.9 1.1z"/></svg>        <span class="sf-toolbar-value sf-toolbar-ajax-request-counter">            Loading&hellip;        </span>    </div>    </a>        <div class="sf-toolbar-info">        <div class="sf-toolbar-info-piece">            <b>Loading the web debug toolbar&hellip;</b>        </div>        <div class="sf-toolbar-info-piece">            Attempt #<span id="sfLoadCounter-da679e"></span>        </div>        <div class="sf-toolbar-info-piece">            <b>                <button class="sf-cancel-button" type="button" id="sfLoadCancel-da679e" title="Cancel loading">Cancel</button>            </b>        </div>    </div></div>                                <button class="hide-button" type="button" id="sfToolbarHideButton-da679e" title="Close Toolbar" accesskey="D" aria-expanded="true" aria-controls="sfToolbarMainContent-da679e">        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="#AAA" d="M21.1 18.3c.8.8.8 2 0 2.8-.4.4-.9.6-1.4.6s-1-.2-1.4-.6L12 14.8l-6.3 6.3c-.4.4-.9.6-1.4.6s-1-.2-1.4-.6a2 2 0 0 1 0-2.8L9.2 12 2.9 5.7a2 2 0 0 1 0-2.8 2 2 0 0 1 2.8 0L12 9.2l6.3-6.3a2 2 0 0 1 2.8 0c.8.8.8 2 0 2.8L14.8 12l6.3 6.3z"/></svg>    </button></div><!-- END of Symfony Web Debug Toolbar --></div><script nonce="b7cbf7b4ff33e4e0981fc79833d5e3d0">/*<![CDATA[*/    if (typeof Sfjs === 'undefined' || typeof Sfjs.loadToolbar === 'undefined') {    Sfjs = (function() {        "use strict";        if ('classList' in document.documentElement) {            var hasClass = function (el, cssClass) { return el.classList.contains(cssClass); };            var removeClass = function(el, cssClass) { el.classList.remove(cssClass); };            var addClass = function(el, cssClass) { el.classList.add(cssClass); };            var toggleClass = function(el, cssClass) { el.classList.toggle(cssClass); };        } else {            var hasClass = function (el, cssClass) { return el.className.match(new RegExp('\\b' + cssClass + '\\b')); };            var removeClass = function(el, cssClass) { el.className = el.className.replace(new RegExp('\\b' + cssClass + '\\b'), ' '); };            var addClass = function(el, cssClass) { if (!hasClass(el, cssClass)) { el.className += " " + cssClass; } };            var toggleClass = function(el, cssClass) { hasClass(el, cssClass) ? removeClass(el, cssClass) : addClass(el, cssClass); };        }        var noop = function() {};        var profilerStorageKey = 'symfony/profiler/';        var addEventListener;        var el = document.createElement('div');        if (!('addEventListener' in el)) {            addEventListener = function (element, eventName, callback) {                element.attachEvent('on' + eventName, callback);            };        } else {            addEventListener = function (element, eventName, callback) {                element.addEventListener(eventName, callback, false);            };        }        if (navigator.clipboard) {            document.querySelectorAll('[data-clipboard-text]').forEach(function(element) {                removeClass(element, 'hidden');                element.addEventListener('click', function() {                    navigator.clipboard.writeText(element.getAttribute('data-clipboard-text'));                })            });        }        var request = function(url, onSuccess, onError, payload, options, tries) {            var xhr = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');            options = options || {};            options.retry = options.retry || false;            tries = tries || 1;            /* this delays for 125, 375, 625, 875, and 1000, ... */            var delay = tries < 5 ? (tries - 0.5) * 250 : 1000;            xhr.open(options.method || 'GET', url, true);            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');            xhr.onreadystatechange = function(state) {                if (4 !== xhr.readyState) {                    return null;                }                if (xhr.status == 404 && options.retry && !options.stop) {                    setTimeout(function() {                        if (options.stop) {                            return;                        }                        request(url, onSuccess, onError, payload, options, tries + 1);                    }, delay);                    return null;                }                if (200 === xhr.status) {                    (onSuccess || noop)(xhr);                } else {                    (onError || noop)(xhr);                }            };            if (options.onSend) {                options.onSend(tries);            }            xhr.send(payload || '');        };        var getPreference = function(name) {            if (!window.localStorage) {                return null;            }            return localStorage.getItem(profilerStorageKey + name);        };        var setPreference = function(name, value) {            if (!window.localStorage) {                return null;            }            localStorage.setItem(profilerStorageKey + name, value);        };        var requestStack = [];        var extractHeaders = function(xhr, stackElement) {            /* Here we avoid to call xhr.getResponseHeader in order to */            /* prevent polluting the console with CORS security errors */            var allHeaders = xhr.getAllResponseHeaders();            var ret;            if (ret = allHeaders.match(/^x-debug-token:\s+(.*)$/im)) {                stackElement.profile = ret[1];            }            if (ret = allHeaders.match(/^x-debug-token-link:\s+(.*)$/im)) {                stackElement.profilerUrl = ret[1];            }            if (ret = allHeaders.match(/^Symfony-Debug-Toolbar-Replace:\s+(.*)$/im)) {                stackElement.toolbarReplaceFinished = false;                stackElement.toolbarReplace = '1' === ret[1];            }        };        var successStreak = 4;        var pendingRequests = 0;        var renderAjaxRequests = function() {            var requestCounter = document.querySelector('.sf-toolbar-ajax-request-counter');            if (!requestCounter) {                return;            }            requestCounter.textContent = requestStack.length;            var infoSpan = document.querySelector(".sf-toolbar-ajax-info");            if (infoSpan) {                infoSpan.textContent = requestStack.length + ' AJAX request' + (requestStack.length !== 1 ? 's' : '');            }            var ajaxToolbarPanel = document.querySelector('.sf-toolbar-block-ajax');            if (requestStack.length) {                ajaxToolbarPanel.style.display = 'block';            } else {                ajaxToolbarPanel.style.display = 'none';            }            if (pendingRequests > 0) {                addClass(ajaxToolbarPanel, 'sf-ajax-request-loading');            } else if (successStreak < 4) {                addClass(ajaxToolbarPanel, 'sf-toolbar-status-red');                removeClass(ajaxToolbarPanel, 'sf-ajax-request-loading');            } else {                removeClass(ajaxToolbarPanel, 'sf-ajax-request-loading');                removeClass(ajaxToolbarPanel, 'sf-toolbar-status-red');            }        };        var startAjaxRequest = function(index) {            var tbody = document.querySelector('.sf-toolbar-ajax-request-list');            if (!tbody) {                return;            }            var nbOfAjaxRequest = tbody.rows.length;            if (nbOfAjaxRequest >= 100) {                tbody.deleteRow(0);            }            var request = requestStack[index];            pendingRequests++;            var row = document.createElement('tr');            request.DOMNode = row;            var requestNumberCell = document.createElement('td');            requestNumberCell.textContent = index + 1;            row.appendChild(requestNumberCell);            var profilerCell = document.createElement('td');            profilerCell.textContent = 'n/a';            row.appendChild(profilerCell);            var methodCell = document.createElement('td');            methodCell.textContent = request.method;            row.appendChild(methodCell);            var typeCell = document.createElement('td');            typeCell.textContent = request.type;            row.appendChild(typeCell);            var statusCodeCell = document.createElement('td');            var statusCode = document.createElement('span');            statusCode.textContent = 'n/a';            statusCodeCell.appendChild(statusCode);            row.appendChild(statusCodeCell);            var pathCell = document.createElement('td');            pathCell.className = 'sf-ajax-request-url';            if ('GET' === request.method) {                var pathLink = document.createElement('a');                pathLink.setAttribute('href', request.url);                pathLink.textContent = request.url;                pathCell.appendChild(pathLink);            } else {                pathCell.textContent = request.url;            }            pathCell.setAttribute('title', request.url);            row.appendChild(pathCell);            var durationCell = document.createElement('td');            durationCell.className = 'sf-ajax-request-duration';            durationCell.textContent = 'n/a';            row.appendChild(durationCell);            request.liveDurationHandle = setInterval(function() {                durationCell.textContent = (new Date() - request.start) + ' ms';            }, 100);            row.className = 'sf-ajax-request sf-ajax-request-loading';            tbody.insertBefore(row, null);            var toolbarInfo = document.querySelector('.sf-toolbar-block-ajax .sf-toolbar-info');            toolbarInfo.scrollTop = toolbarInfo.scrollHeight;            renderAjaxRequests();        };        var finishAjaxRequest = function(index) {            var request = requestStack[index];            clearInterval(request.liveDurationHandle);            if (!request.DOMNode) {                return;            }            if (request.toolbarReplace && !request.toolbarReplaceFinished && request.profile) {                /* Flag as complete because finishAjaxRequest can be called multiple times. */                request.toolbarReplaceFinished = true;                /* Search up through the DOM to find the toolbar's container ID. */                for (var elem = request.DOMNode; elem && elem !== document; elem = elem.parentNode) {                    if (elem.id.match(/^sfwdt/)) {                        Sfjs.loadToolbar(elem.id.replace(/^sfwdt/, ''), request.profile);                        break;                    }                }            }            pendingRequests--;            var row = request.DOMNode;            /* Unpack the children from the row */            var profilerCell = row.children[1];            var methodCell = row.children[2];            var statusCodeCell = row.children[4];            var statusCodeElem = statusCodeCell.children[0];            var durationCell = row.children[6];            if (request.error) {                row.className = 'sf-ajax-request sf-ajax-request-error';                methodCell.className = 'sf-ajax-request-error';                successStreak = 0;            } else {                row.className = 'sf-ajax-request sf-ajax-request-ok';                successStreak++;            }            if (request.statusCode) {                if (request.statusCode < 300) {                    statusCodeElem.setAttribute('class', 'sf-toolbar-status');                } else if (request.statusCode < 400) {                    statusCodeElem.setAttribute('class', 'sf-toolbar-status sf-toolbar-status-yellow');                } else {                    statusCodeElem.setAttribute('class', 'sf-toolbar-status sf-toolbar-status-red');                }                statusCodeElem.textContent = request.statusCode;            } else {                statusCodeElem.setAttribute('class', 'sf-toolbar-status sf-toolbar-status-red');            }            if (request.duration) {                durationCell.textContent = request.duration + ' ms';            }            if (request.profilerUrl) {                profilerCell.textContent = '';                var profilerLink = document.createElement('a');                profilerLink.setAttribute('href', request.profilerUrl);                profilerLink.textContent = request.profile;                profilerCell.appendChild(profilerLink);            }            renderAjaxRequests();        };                    if (window.fetch && window.fetch.polyfill === undefined) {                var oldFetch = window.fetch;                window.fetch = function () {                    var promise = oldFetch.apply(this, arguments);                    var url = arguments[0];                    var params = arguments[1];                    var paramType = Object.prototype.toString.call(arguments[0]);                    if (paramType === '[object Request]') {                        url = arguments[0].url;                        params = {                            method: arguments[0].method,                            credentials: arguments[0].credentials,                            headers: arguments[0].headers,                            mode: arguments[0].mode,                            redirect: arguments[0].redirect                        };                    } else {                        url = String(url);                    }                    if (!url.match(new RegExp("^\/((index|app(_[\\w]+)?)\\.php\/)?_wdt"))) {                        var method = 'GET';                        if (params && params.method !== undefined) {                            method = params.method;                        }                        var stackElement = {                            error: false,                            url: url,                            method: method,                            type: 'fetch',                            start: new Date()                        };                        var idx = requestStack.push(stackElement) - 1;                        promise.then(function (r) {                            stackElement.duration = new Date() - stackElement.start;                            stackElement.error = r.status < 200 || r.status >= 400;                            stackElement.statusCode = r.status;                            stackElement.profile = r.headers.get('x-debug-token');                            stackElement.profilerUrl = r.headers.get('x-debug-token-link');                            stackElement.toolbarReplaceFinished = false;                            stackElement.toolbarReplace = '1' === r.headers.get('Symfony-Debug-Toolbar-Replace');                            finishAjaxRequest(idx);                        }, function (e){                            stackElement.error = true;                            finishAjaxRequest(idx);                        });                        startAjaxRequest(idx);                    }                    return promise;                };            }            if (window.XMLHttpRequest && XMLHttpRequest.prototype.addEventListener) {                var proxied = XMLHttpRequest.prototype.open;                XMLHttpRequest.prototype.open = function(method, url, async, user, pass) {                    var self = this;                    /* prevent logging AJAX calls to static and inline files, like templates */                    var path = url;                    if (url.slice(0, 1) === '/') {                        if (0 === url.indexOf('\/public')) {                            path = url.slice(7);                        }                    }                    else if (0 === url.indexOf('http\u003A\/\/localhost\u003A8888\/public')) {                        path = url.slice(28);                    }                    if (!path.match(new RegExp("^\/((index|app(_[\\w]+)?)\\.php\/)?_wdt"))) {                        var stackElement = {                            error: false,                            url: url,                            method: method,                            type: 'xhr',                            start: new Date()                        };                        var idx = requestStack.push(stackElement) - 1;                        this.addEventListener('readystatechange', function() {                            if (self.readyState == 4) {                                stackElement.duration = new Date() - stackElement.start;                                stackElement.error = self.status < 200 || self.status >= 400;                                stackElement.statusCode = self.status;                                extractHeaders(self, stackElement);                                finishAjaxRequest(idx);                            }                        }, false);                        startAjaxRequest(idx);                    }                    proxied.apply(this, Array.prototype.slice.call(arguments));                };            }                return {            hasClass: hasClass,            removeClass: removeClass,            addClass: addClass,            toggleClass: toggleClass,            getPreference: getPreference,            setPreference: setPreference,            addEventListener: addEventListener,            request: request,            renderAjaxRequests: renderAjaxRequests,            getSfwdt: function(token) {                if (!this.sfwdt) {                    this.sfwdt = document.getElementById('sfwdt' + token);                }                return this.sfwdt;            },            load: function(selector, url, onSuccess, onError, options) {                var el = document.getElementById(selector);                if (el && el.getAttribute('data-sfurl') !== url) {                    request(                        url,                        function(xhr) {                            el.innerHTML = xhr.responseText;                            el.setAttribute('data-sfurl', url);                            removeClass(el, 'loading');                            var pending = pendingRequests;                            for (var i = 0; i < requestStack.length; i++) {                                startAjaxRequest(i);                                if (requestStack[i].duration) {                                    finishAjaxRequest(i);                                }                            }                            /* Revert the pending state in case there was a start called without a finish above. */                            pendingRequests = pending;                            (onSuccess || noop)(xhr, el);                        },                        function(xhr) { (onError || noop)(xhr, el); },                        '',                        options                    );                }                return this;            },            showToolbar: function(token) {                var sfwdt = this.getSfwdt(token);                removeClass(sfwdt, 'sf-display-none');                if (getPreference('toolbar/displayState') == 'none') {                    document.getElementById('sfToolbarMainContent-' + token).style.display = 'none';                    document.getElementById('sfToolbarClearer-' + token).style.display = 'none';                    document.getElementById('sfMiniToolbar-' + token).style.display = 'block';                } else {                    document.getElementById('sfToolbarMainContent-' + token).style.display = 'block';                    document.getElementById('sfToolbarClearer-' + token).style.display = 'block';                    document.getElementById('sfMiniToolbar-' + token).style.display = 'none';                }            },            hideToolbar: function(token) {                var sfwdt = this.getSfwdt(token);                addClass(sfwdt, 'sf-display-none');            },            initToolbar: function(token) {                this.showToolbar(token);                var hideButton = document.getElementById('sfToolbarHideButton-' + token);                var hideButtonSvg = hideButton.querySelector('svg');                hideButtonSvg.setAttribute('aria-hidden', 'true');                hideButtonSvg.setAttribute('focusable', 'false');                addEventListener(hideButton, 'click', function (event) {                    event.preventDefault();                    var p = this.parentNode;                    p.style.display = 'none';                    (p.previousElementSibling || p.previousSibling).style.display = 'none';                    document.getElementById('sfMiniToolbar-' + token).style.display = 'block';                    setPreference('toolbar/displayState', 'none');                });                var showButton = document.getElementById('sfToolbarMiniToggler-' + token);                var showButtonSvg = showButton.querySelector('svg');                showButtonSvg.setAttribute('aria-hidden', 'true');                showButtonSvg.setAttribute('focusable', 'false');                addEventListener(showButton, 'click', function (event) {                    event.preventDefault();                    var elem = this.parentNode;                    if (elem.style.display == 'none') {                        document.getElementById('sfToolbarMainContent-' + token).style.display = 'none';                        document.getElementById('sfToolbarClearer-' + token).style.display = 'none';                        elem.style.display = 'block';                    } else {                        document.getElementById('sfToolbarMainContent-' + token).style.display = 'block';                        document.getElementById('sfToolbarClearer-' + token).style.display = 'block';                        elem.style.display = 'none'                    }                    setPreference('toolbar/displayState', 'block');                });            },            loadToolbar: function(token, newToken) {                var that = this;                var triesCounter = document.getElementById('sfLoadCounter-' + token);                var options = {                    retry: true,                    onSend: function (count) {                        if (count === 3) {                            that.initToolbar(token);                        }                        if (triesCounter) {                            triesCounter.textContent = count;                        }                    },                };                var cancelButton = document.getElementById('sfLoadCancel-' + token);                if (cancelButton) {                    addEventListener(cancelButton, 'click', function (event) {                        event.preventDefault();                        options.stop = true;                        that.hideToolbar(token);                    });                }                newToken = (newToken || token);                this.load(                    'sfwdt' + token,                    'http\u003A\/\/localhost\u003A8888\/public\/_wdt\/xxxxxx'.replace(/xxxxxx/, newToken),                    function(xhr, el) {                        /* Do nothing in the edge case where the toolbar has already been replaced with a new one */                        if (!document.getElementById('sfToolbarMainContent-' + newToken)) {                            return;                        }                        /* Evaluate in global scope scripts embedded inside the toolbar */                        var i, scripts = [].slice.call(el.querySelectorAll('script'));                        for (i = 0; i < scripts.length; ++i) {                            if (scripts[i].firstChild) {                                eval.call({}, scripts[i].firstChild.nodeValue);                            }                        }                        el.style.display = -1 !== xhr.responseText.indexOf('sf-toolbarreset') ? 'block' : 'none';                        if (el.style.display == 'none') {                            return;                        }                        that.initToolbar(newToken);                        /* Handle toolbar-info position */                        var toolbarBlocks = [].slice.call(el.querySelectorAll('.sf-toolbar-block'));                        for (i = 0; i < toolbarBlocks.length; ++i) {                            toolbarBlocks[i].onmouseover = function () {                                var toolbarInfo = this.querySelectorAll('.sf-toolbar-info')[0];                                var pageWidth = document.body.clientWidth;                                var elementWidth = toolbarInfo.offsetWidth;                                var leftValue = (elementWidth + this.offsetLeft) - pageWidth;                                var rightValue = (elementWidth + (pageWidth - this.offsetLeft)) - pageWidth;                                /* Reset right and left value, useful on window resize */                                toolbarInfo.style.right = '';                                toolbarInfo.style.left = '';                                if (elementWidth > pageWidth) {                                    toolbarInfo.style.left = 0;                                }                                else if (leftValue > 0 && rightValue > 0) {                                    toolbarInfo.style.right = (rightValue * -1) + 'px';                                } else if (leftValue < 0) {                                    toolbarInfo.style.left = 0;                                } else {                                    toolbarInfo.style.right = '0px';                                }                            };                        }                        renderAjaxRequests();                        addEventListener(document.querySelector('.sf-toolbar-ajax-clear'), 'click', function() {                            requestStack = [];                            renderAjaxRequests();                            successStreak = 4;                            document.querySelector('.sf-toolbar-ajax-request-list').innerHTML = '';                        });                        addEventListener(document.querySelector('.sf-toolbar-block-ajax'), 'mouseenter', function (event) {                            var elem = document.querySelector('.sf-toolbar-block-ajax .sf-toolbar-info');                            elem.scrollTop = elem.scrollHeight;                        });                        addEventListener(document.querySelector('.sf-toolbar-block-ajax > .sf-toolbar-icon'), 'click', function (event) {                            event.preventDefault();                            toggleClass(this.parentNode, 'hover');                        });                        var dumpInfo = document.querySelector('.sf-toolbar-block-dump .sf-toolbar-info');                        if (null !== dumpInfo) {                            addEventListener(dumpInfo, 'sfbeforedumpcollapse', function () {                                dumpInfo.style.minHeight = dumpInfo.getBoundingClientRect().height+'px';                            });                            addEventListener(dumpInfo, 'mouseleave', function () {                                dumpInfo.style.minHeight = '';                            });                        }                    },                    function(xhr) {                        if (xhr.status !== 0 && !options.stop) {                            var sfwdt = that.getSfwdt(token);                            sfwdt.innerHTML = '\                                <div class="sf-toolbarreset">\                                    <div class="sf-toolbar-icon"><svg width="26" height="28" xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 26 28" enable-background="new 0 0 26 28" xml:space="preserve"><path fill="#FFFFFF" d="M13 0C5.8 0 0 5.8 0 13c0 7.2 5.8 13 13 13c7.2 0 13-5.8 13-13C26 5.8 20.2 0 13 0z M20 7.5 c-0.6 0-1-0.3-1-0.9c0-0.2 0-0.4 0.2-0.6c0.1-0.3 0.2-0.3 0.2-0.4c0-0.3-0.5-0.4-0.7-0.4c-2 0.1-2.5 2.7-2.9 4.8l-0.2 1.1 c1.1 0.2 1.9 0 2.4-0.3c0.6-0.4-0.2-0.8-0.1-1.3C18 9.2 18.4 9 18.7 8.9c0.5 0 0.8 0.5 0.8 1c0 0.8-1.1 2-3.3 1.9 c-0.3 0-0.5 0-0.7-0.1L15 14.1c-0.4 1.7-0.9 4.1-2.6 6.2c-1.5 1.8-3.1 2.1-3.8 2.1c-1.3 0-2.1-0.6-2.2-1.6c0-0.9 0.8-1.4 1.3-1.4 c0.7 0 1.2 0.5 1.2 1.1c0 0.5-0.2 0.6-0.4 0.7c-0.1 0.1-0.3 0.2-0.3 0.4c0 0.1 0.1 0.3 0.4 0.3c0.5 0 0.9-0.3 1.2-0.5 c1.3-1 1.7-2.9 2.4-6.2l0.1-0.8c0.2-1.1 0.5-2.3 0.8-3.5c-0.9-0.7-1.4-1.5-2.6-1.8c-0.8-0.2-1.3 0-1.7 0.4C8.4 10 8.6 10.7 9 11.1 l0.7 0.7c0.8 0.9 1.3 1.7 1.1 2.7c-0.3 1.6-2.1 2.8-4.3 2.1c-1.9-0.6-2.2-1.9-2-2.7c0.2-0.6 0.7-0.8 1.2-0.6 c0.5 0.2 0.7 0.8 0.6 1.3c0 0.1 0 0.1-0.1 0.3C6 15 5.9 15.2 5.9 15.3c-0.1 0.4 0.4 0.7 0.8 0.8c0.8 0.3 1.7-0.2 1.9-0.9 c0.2-0.6-0.2-1.1-0.4-1.2l-0.8-0.9c-0.4-0.4-1.2-1.5-0.8-2.8c0.2-0.5 0.5-1 0.9-1.4c1-0.7 2-0.8 3-0.6c1.3 0.4 1.9 1.2 2.8 1.9 c0.5-1.3 1.1-2.6 2-3.8c0.9-1 2-1.7 3.3-1.8C20 4.8 21 5.4 21 6.3C21 6.7 20.8 7.5 20 7.5z"/></svg></div>\                                    An error occurred while loading the web debug toolbar. <a href="http\u003A\/\/localhost\u003A8888\/public\/_profiler\/' + newToken + '">Open the web profiler.</a>\                                </div>\                            ';                            sfwdt.setAttribute('class', 'sf-toolbar sf-error-toolbar');                        }                    },                    options                );                return this;            },            toggle: function(selector, elOn, elOff) {                var tmp = elOn.style.display,                    el = document.getElementById(selector);                elOn.style.display = elOff.style.display;                elOff.style.display = tmp;                if (el) {                    el.style.display = 'none' === tmp ? 'none' : 'block';                }                return this;            },            createTabs: function() {                var tabGroups = document.querySelectorAll('.sf-tabs:not([data-processed=true])');                /* create the tab navigation for each group of tabs */                for (var i = 0; i < tabGroups.length; i++) {                    var tabs = tabGroups[i].querySelectorAll(':scope > .tab');                    var tabNavigation = document.createElement('ul');                    tabNavigation.className = 'tab-navigation';                    var selectedTabId = 'tab-' + i + '-0'; /* select the first tab by default */                    for (var j = 0; j < tabs.length; j++) {                        var tabId = 'tab-' + i + '-' + j;                        var tabTitle = tabs[j].querySelector('.tab-title').innerHTML;                        var tabNavigationItem = document.createElement('li');                        tabNavigationItem.setAttribute('data-tab-id', tabId);                        if (hasClass(tabs[j], 'active')) { selectedTabId = tabId; }                        if (hasClass(tabs[j], 'disabled')) { addClass(tabNavigationItem, 'disabled'); }                        tabNavigationItem.innerHTML = tabTitle;                        tabNavigation.appendChild(tabNavigationItem);                        var tabContent = tabs[j].querySelector('.tab-content');                        tabContent.parentElement.setAttribute('id', tabId);                    }                    tabGroups[i].insertBefore(tabNavigation, tabGroups[i].firstChild);                    addClass(document.querySelector('[data-tab-id="' + selectedTabId + '"]'), 'active');                }                /* display the active tab and add the 'click' event listeners */                for (i = 0; i < tabGroups.length; i++) {                    tabNavigation = tabGroups[i].querySelectorAll(':scope > .tab-navigation li');                    for (j = 0; j < tabNavigation.length; j++) {                        tabId = tabNavigation[j].getAttribute('data-tab-id');                        document.getElementById(tabId).querySelector('.tab-title').className = 'hidden';                        if (hasClass(tabNavigation[j], 'active')) {                            document.getElementById(tabId).className = 'block';                        } else {                            document.getElementById(tabId).className = 'hidden';                        }                        tabNavigation[j].addEventListener('click', function(e) {                            var activeTab = e.target || e.srcElement;                            /* needed because when the tab contains HTML contents, user can click */                            /* on any of those elements instead of their parent '<li>' element */                            while (activeTab.tagName.toLowerCase() !== 'li') {                                activeTab = activeTab.parentNode;                            }                            /* get the full list of tabs through the parent of the active tab element */                            var tabNavigation = activeTab.parentNode.children;                            for (var k = 0; k < tabNavigation.length; k++) {                                var tabId = tabNavigation[k].getAttribute('data-tab-id');                                document.getElementById(tabId).className = 'hidden';                                removeClass(tabNavigation[k], 'active');                            }                            addClass(activeTab, 'active');                            var activeTabId = activeTab.getAttribute('data-tab-id');                            document.getElementById(activeTabId).className = 'block';                        });                    }                    tabGroups[i].setAttribute('data-processed', 'true');                }            },            createToggles: function() {                var toggles = document.querySelectorAll('.sf-toggle:not([data-processed=true])');                for (var i = 0; i < toggles.length; i++) {                    var elementSelector = toggles[i].getAttribute('data-toggle-selector');                    var element = document.querySelector(elementSelector);                    addClass(element, 'sf-toggle-content');                    if (toggles[i].hasAttribute('data-toggle-initial') && toggles[i].getAttribute('data-toggle-initial') == 'display') {                        addClass(toggles[i], 'sf-toggle-on');                        addClass(element, 'sf-toggle-visible');                    } else {                        addClass(toggles[i], 'sf-toggle-off');                        addClass(element, 'sf-toggle-hidden');                    }                    addEventListener(toggles[i], 'click', function(e) {                        e.preventDefault();                        if ('' !== window.getSelection().toString()) {                            /* Don't do anything on text selection */                            return;                        }                        var toggle = e.target || e.srcElement;                        /* needed because when the toggle contains HTML contents, user can click */                        /* on any of those elements instead of their parent '.sf-toggle' element */                        while (!hasClass(toggle, 'sf-toggle')) {                            toggle = toggle.parentNode;                        }                        var element = document.querySelector(toggle.getAttribute('data-toggle-selector'));                        toggleClass(toggle, 'sf-toggle-on');                        toggleClass(toggle, 'sf-toggle-off');                        toggleClass(element, 'sf-toggle-hidden');                        toggleClass(element, 'sf-toggle-visible');                        /* the toggle doesn't change its contents when clicking on it */                        if (!toggle.hasAttribute('data-toggle-alt-content')) {                            return;                        }                        if (!toggle.hasAttribute('data-toggle-original-content')) {                            toggle.setAttribute('data-toggle-original-content', toggle.innerHTML);                        }                        var currentContent = toggle.innerHTML;                        var originalContent = toggle.getAttribute('data-toggle-original-content');                        var altContent = toggle.getAttribute('data-toggle-alt-content');                        toggle.innerHTML = currentContent !== altContent ? altContent : originalContent;                    });                    /* Prevents from disallowing clicks on links inside toggles */                    var toggleLinks = toggles[i].querySelectorAll('a');                    for (var j = 0; j < toggleLinks.length; j++) {                        addEventListener(toggleLinks[j], 'click', function(e) {                            e.stopPropagation();                        });                    }                    /* Prevents from disallowing clicks on "copy to clipboard" elements inside toggles */                    var copyToClipboardElements = toggles[i].querySelectorAll('span[data-clipboard-text]');                    for (var k = 0; k < copyToClipboardElements.length; k++) {                        addEventListener(copyToClipboardElements[k], 'click', function(e) {                            e.stopPropagation();                        });                    }                    toggles[i].setAttribute('data-processed', 'true');                }            },            initializeLogsTable: function() {                Sfjs.updateLogsTable();                document.querySelectorAll('.log-filter input').forEach((input) => {                    input.addEventListener('change', () => { Sfjs.updateLogsTable(); });                });                document.querySelectorAll('.filter-select-all-or-none button').forEach((link) => {                    link.addEventListener('click', () => {                        const selectAll = link.classList.contains('select-all');                        link.closest('.log-filter-content').querySelectorAll('input').forEach((input) => {                            input.checked = selectAll;                        });                        Sfjs.updateLogsTable();                    });                });                document.body.addEventListener('click', (event) => {                    document.querySelectorAll('details.log-filter').forEach((filterElement) => {                        if (!filterElement.contains(event.target) && filterElement.open) {                            filterElement.open = false;                        }                    });                });            },            updateLogsTable: function() {                const selectedType = document.querySelector('#log-filter-type input:checked').value;                const priorities = document.querySelectorAll('#log-filter-priority input');                const allPriorities = Array.from(priorities).map((input) => input.value);                const selectedPriorities = Array.from(priorities).filter((input) => input.checked).map((input) => input.value);                const channels = document.querySelectorAll('#log-filter-channel input');                const selectedChannels = Array.from(channels).filter((input) => input.checked).map((input) => input.value);                const logs = document.querySelector('table.logs');                if (null === logs) {                    return;                }                /* hide rows that don't match the current filters */                let numVisibleRows = 0;                logs.querySelectorAll('tbody tr').forEach((row) => {                    if ('all' !== selectedType && selectedType !== row.getAttribute('data-type')) {                        row.style.display = 'none';                        return;                    }                    const priority = row.getAttribute('data-priority');                    if (false === selectedPriorities.includes(priority) && true === allPriorities.includes(priority)) {                        row.style.display = 'none';                        return;                    }                    if ('' !== row.getAttribute('data-channel') && false === selectedChannels.includes(row.getAttribute('data-channel'))) {                        row.style.display = 'none';                        return;                    }                    row.style.display = 'table-row';                    numVisibleRows++;                });                document.querySelector('table.logs').style.display = 0 === numVisibleRows ? 'none' : 'table';                document.querySelector('.no-logs-message').style.display = 0 === numVisibleRows ? 'block' : 'none';                /* update the selected totals of all filters */                document.querySelector('#log-filter-priority .filter-active-num').innerText = (priorities.length === selectedPriorities.length) ? 'All' : selectedPriorities.length;                document.querySelector('#log-filter-channel .filter-active-num').innerText = (channels.length === selectedChannels.length) ? 'All' : selectedChannels.length;                /* update the currently selected "log type" tab */                document.querySelectorAll('#log-filter-type li').forEach((tab) => tab.classList.remove('active'));                document.querySelector(`#log-filter-type input[value="${selectedType}"]`).parentElement.classList.add('active');            },        };    })();    Sfjs.addEventListener(document, 'DOMContentLoaded', function() {        Sfjs.createTabs();        Sfjs.createToggles();    });}/*]]>*/</script><style nonce="6c7fd6499779144e72d57f391e382a7b">    .sf-minitoolbar {    background-color: #222;    border-top-left-radius: 4px;    bottom: 0;    box-sizing: border-box;    display: none;    height: 36px;    padding: 6px;    position: fixed;    right: 0;    z-index: 99999;}.sf-minitoolbar button {    background-color: transparent;    padding: 0;    border: none;}.sf-minitoolbar svg,.sf-minitoolbar img {    max-height: 24px;    max-width: 24px;    display: inline;}.sf-toolbar-clearer {    clear: both;    height: 36px;}.sf-display-none {    display: none;}.sf-toolbarreset * {    box-sizing: content-box;    vertical-align: baseline;    letter-spacing: normal;    width: auto;}.sf-toolbarreset {    background-color: #222;    bottom: 0;    box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.2);    color: #EEE;    font: 11px Arial, sans-serif;    left: 0;    margin: 0;    padding: 0 36px 0 0;    position: fixed;    right: 0;    text-align: left;    text-transform: none;    z-index: 99999;    direction: ltr;    /* neutralize the aliasing defined by external CSS styles */    -webkit-font-smoothing: subpixel-antialiased;    -moz-osx-font-smoothing: auto;}.sf-toolbarreset abbr {    border: dashed #777;    border-width: 0 0 1px;}.sf-toolbarreset svg,.sf-toolbarreset img {    height: 20px;    width: 20px;    display: inline-block;}.sf-toolbarreset .sf-cancel-button {    color: #444;}.sf-toolbarreset .hide-button {    background: #444;    display: block;    position: absolute;    top: 0;    right: 0;    width: 36px;    height: 36px;    cursor: pointer;    text-align: center;    border: none;    margin: 0;    padding: 0;}.sf-toolbarreset .hide-button svg {    max-height: 18px;    margin-top: 1px;}.sf-toolbar-block {    cursor: default;    display: block;    float: left;    height: 36px;    margin-right: 0;    white-space: nowrap;    max-width: 15%;}.sf-toolbar-block > a,.sf-toolbar-block > a:hover {    display: block;    text-decoration: none;    background-color: transparent;    color: inherit;}.sf-toolbar-block span {    display: inline-block;}.sf-toolbar-block .sf-toolbar-value {    color: #F5F5F5;    font-size: 13px;    line-height: 36px;    padding: 0;}.sf-toolbar-block .sf-toolbar-label,.sf-toolbar-block .sf-toolbar-class-separator {    color: #AAA;    font-size: 12px;}.sf-toolbar-block .sf-toolbar-info {    border-collapse: collapse;    display: table;    z-index: 100000;}.sf-toolbar-block hr {    border-top: 1px solid #777;    margin: 4px 0;    padding-top: 4px;}.sf-toolbar-block .sf-toolbar-info-piece {    /* this 'border-bottom' trick is needed because 'margin-bottom' doesn't work for table rows */    border-bottom: solid transparent 3px;    display: table-row;}.sf-toolbar-block .sf-toolbar-info-piece-additional,.sf-toolbar-block .sf-toolbar-info-piece-additional-detail {    display: none;}.sf-toolbar-block .sf-toolbar-info-group {    margin-bottom: 4px;    padding-bottom: 2px;    border-bottom: 1px solid #333333;}.sf-toolbar-block .sf-toolbar-info-group:last-child {    margin-bottom: 0;    padding-bottom: 0;    border-bottom: none;}.sf-toolbar-block .sf-toolbar-info-piece .sf-toolbar-status {    padding: 2px 5px;    margin-bottom: 0;}.sf-toolbar-block .sf-toolbar-info-piece .sf-toolbar-status + .sf-toolbar-status {    margin-left: 4px;}.sf-toolbar-block .sf-toolbar-info-piece:last-child {    margin-bottom: 0;}div.sf-toolbar .sf-toolbar-block .sf-toolbar-info-piece a {    color: #99CDD8;    text-decoration: underline;}div.sf-toolbar .sf-toolbar-block a:hover {    text-decoration: none;}.sf-toolbar-block .sf-toolbar-info-piece b {    color: #AAA;    display: table-cell;    font-size: 11px;    padding: 4px 8px 4px 0;}.sf-toolbar-block:not(.sf-toolbar-block-dump) .sf-toolbar-info-piece span {    color: #F5F5F5;}.sf-toolbar-block .sf-toolbar-info-piece span {    font-size: 12px;}.sf-toolbar-block .sf-toolbar-info {    background-color: #444;    bottom: 36px;    color: #F5F5F5;    display: none;    padding: 9px 0;    position: absolute;}.sf-toolbar-block .sf-toolbar-info:empty {    visibility: hidden;}.sf-toolbar-block .sf-toolbar-status {    display: inline-block;    color: #FFF;    background-color: #666;    padding: 3px 6px;    margin-bottom: 2px;    vertical-align: middle;    min-width: 15px;    min-height: 13px;    text-align: center;}.sf-toolbar-block .sf-toolbar-status-green {    background-color: #4F805D;}.sf-toolbar-block .sf-toolbar-status-red {    background-color: #B0413E;}.sf-toolbar-block .sf-toolbar-status-yellow {    background-color: #A46A1F;}.sf-toolbar-block.sf-toolbar-status-green {    background-color: #4F805D;    color: #FFF;}.sf-toolbar-block.sf-toolbar-status-red {    background-color: #B0413E;    color: #FFF;}.sf-toolbar-block.sf-toolbar-status-yellow {    background-color: #A46A1F;    color: #FFF;}.sf-toolbar-block-request .sf-toolbar-status {    color: #FFF;    display: inline-block;    font-size: 14px;    height: 36px;    line-height: 36px;    padding: 0 10px;}.sf-toolbar-block-request .sf-toolbar-info-piece a {    background-color: transparent;    text-decoration: none;}.sf-toolbar-block-request .sf-toolbar-info-piece a:hover {    text-decoration: underline;}.sf-toolbar-block-request .sf-toolbar-redirection-status {    font-weight: normal;    padding: 2px 4px;    line-height: 18px;}.sf-toolbar-block-request .sf-toolbar-info-piece span.sf-toolbar-redirection-method {    font-size: 12px;    height: 17px;    line-height: 17px;    margin-right: 5px;}.sf-toolbar-block-ajax .sf-toolbar-icon {    cursor: pointer;}.sf-toolbar-status-green .sf-toolbar-label,.sf-toolbar-status-yellow .sf-toolbar-label,.sf-toolbar-status-red .sf-toolbar-label {    color: #FFF;}.sf-toolbar-status-green svg path,.sf-toolbar-status-green svg .sf-svg-path,.sf-toolbar-status-red svg path,.sf-toolbar-status-red svg .sf-svg-path,.sf-toolbar-status-yellow svg path,.sf-toolbar-status-yellow svg .sf-svg-path {    fill: #FFF;}.sf-toolbar-block-config svg path,.sf-toolbar-block-config svg .sf-svg-path {    fill: #FFF;}.sf-toolbar-block .sf-toolbar-icon {    display: block;    height: 36px;    padding: 0 7px;    overflow: hidden;    text-overflow: ellipsis;}.sf-toolbar-block-request .sf-toolbar-icon {    padding-left: 0;    padding-right: 0;}.sf-toolbar-block .sf-toolbar-icon img,.sf-toolbar-block .sf-toolbar-icon svg {    border-width: 0;    position: relative;    top: 8px;    vertical-align: baseline;}.sf-toolbar-block .sf-toolbar-icon img + span,.sf-toolbar-block .sf-toolbar-icon svg + span {    margin-left: 4px;}.sf-toolbar-block-config .sf-toolbar-icon .sf-toolbar-value {    margin-left: 4px;}.sf-toolbar-block:hover,.sf-toolbar-block.hover {    position: relative;}.sf-toolbar-block:hover .sf-toolbar-icon,.sf-toolbar-block.hover .sf-toolbar-icon {    background-color: #444;    position: relative;    z-index: 10002;}.sf-toolbar-block-ajax.hover .sf-toolbar-info {    z-index: 10001;}.sf-toolbar-block:hover .sf-toolbar-info,.sf-toolbar-block.hover .sf-toolbar-info {    display: block;    padding: 10px;    max-width: 525px;    max-height: 480px;    word-wrap: break-word;    overflow: hidden;    overflow-y: auto;}.sf-toolbar-info-piece b.sf-toolbar-ajax-info {    color: #F5F5F5;}.sf-toolbar-ajax-requests {    table-layout: auto;    width: 100%;}.sf-toolbar-ajax-requests td {    background-color: #444;    border-bottom: 1px solid #777;    color: #F5F5F5;    font-size: 12px;    padding: 4px;}.sf-toolbar-ajax-requests tr:last-child td {    border-bottom: 0;}.sf-toolbar-ajax-requests th {    background-color: #222;    border-bottom: 0;    color: #AAA;    font-size: 11px;    padding: 4px;}.sf-ajax-request-url {    max-width: 250px;    line-height: 9px;    overflow: hidden;    text-overflow: ellipsis;}.sf-toolbar-ajax-requests .sf-ajax-request-url a {    text-decoration: none;}.sf-toolbar-ajax-requests .sf-ajax-request-url a:hover {    text-decoration: underline;}.sf-ajax-request-duration {    text-align: right;}.sf-ajax-request-loading {    animation: sf-blink .5s ease-in-out infinite;}@keyframes sf-blink {    0% { background: #222; }    50% { background: #444; }    100% { background: #222; }}.sf-toolbar-block.sf-toolbar-block-dump .sf-toolbar-info {    max-width: none;    width: 100%;    position: fixed;    box-sizing: border-box;    left: 0;}.sf-toolbar-block-dump pre.sf-dump {    background-color: #222;    border-color: #777;    border-radius: 0;    margin: 6px 0 12px 0;}.sf-toolbar-block-dump pre.sf-dump:last-child {    margin-bottom: 0;}.sf-toolbar-block-dump pre.sf-dump .sf-dump-search-wrapper {    margin-bottom: 5px;}.sf-toolbar-block-dump pre.sf-dump span.sf-dump-search-count {    color: #333;    font-size: 12px;}.sf-toolbar-block-dump .sf-toolbar-info-piece {    display: block;}.sf-toolbar-block-dump .sf-toolbar-info-piece .sf-toolbar-file-line {    color: #AAA;    margin-left: 4px;}.sf-toolbar-block-dump .sf-toolbar-info img {    display: none;}/* Responsive Design */.sf-toolbar-icon .sf-toolbar-label,.sf-toolbar-icon .sf-toolbar-value {    display: none;}.sf-toolbar-block-config .sf-toolbar-icon .sf-toolbar-label {    display: inline-block;}/* Legacy Design - these styles are maintained to make old panels look   a bit better on the new toolbar */.sf-toolbar-block .sf-toolbar-info-piece-additional-detail {    color: #AAA;    font-size: 12px;}.sf-toolbar-status-green .sf-toolbar-info-piece-additional-detail,.sf-toolbar-status-yellow .sf-toolbar-info-piece-additional-detail,.sf-toolbar-status-red .sf-toolbar-info-piece-additional-detail {    color: #FFF;}@media (min-width: 768px) {    .sf-toolbar-icon .sf-toolbar-label,    .sf-toolbar-icon .sf-toolbar-value {        display: inline;    }    .sf-toolbar-block .sf-toolbar-icon img,    .sf-toolbar-block .sf-toolbar-icon svg {        top: 6px;    }    .sf-toolbar-block-time .sf-toolbar-icon svg,    .sf-toolbar-block-memory .sf-toolbar-icon svg {        display: none;    }    .sf-toolbar-block-time .sf-toolbar-icon svg + span,    .sf-toolbar-block-memory .sf-toolbar-icon svg + span {        margin-left: 0;    }    .sf-toolbar-block .sf-toolbar-icon {        padding: 0 10px;    }    .sf-toolbar-block-time .sf-toolbar-icon {        padding-right: 5px;    }    .sf-toolbar-block-memory .sf-toolbar-icon {        padding-left: 5px;    }    .sf-toolbar-block-request .sf-toolbar-icon {        padding-left: 0;        padding-right: 0;    }    .sf-toolbar-block-request .sf-toolbar-label {        margin-left: 5px;    }    .sf-toolbar-block-request .sf-toolbar-status + svg {        margin-left: 5px;    }    .sf-toolbar-block-request .sf-toolbar-icon svg + .sf-toolbar-label {        margin-left: 0;     }    .sf-toolbar-block-request .sf-toolbar-label + .sf-toolbar-value {        margin-right: 10px;    }    .sf-toolbar-block-request:hover .sf-toolbar-info {        max-width: none;    }    .sf-toolbar-block .sf-toolbar-info-piece b {        font-size: 12px;    }    .sf-toolbar-block .sf-toolbar-info-piece span {        font-size: 13px;    }    .sf-toolbar-block-right {        float: right;        margin-left: 0;        margin-right: 0;    }}@media (min-width: 1024px) {    .sf-toolbar-block .sf-toolbar-info-piece-additional,    .sf-toolbar-block .sf-toolbar-info-piece-additional-detail {        display: inline;    }    .sf-toolbar-block .sf-toolbar-info-piece-additional:empty,    .sf-toolbar-block .sf-toolbar-info-piece-additional-detail:empty {        display: none;    }}/***** Error Toolbar *****/.sf-error-toolbar .sf-toolbarreset {    background: #222;    color: #f5f5f5;    font: 13px/36px Arial, sans-serif;    height: 36px;    padding: 0 15px;    text-align: left;}.sf-error-toolbar .sf-toolbarreset svg {    height: auto;}.sf-error-toolbar .sf-toolbarreset a {    color: #99cdd8;    margin-left: 5px;    text-decoration: underline;}.sf-error-toolbar .sf-toolbarreset a:hover {    text-decoration: none;}.sf-error-toolbar .sf-toolbarreset .sf-toolbar-icon {    float: left;    padding: 5px 0;    margin-right: 10px;}.sf-full-stack {    left: 0px;    font-size: 12px;}/***** Media query print: Do not print the Toolbar. *****/@media print {    .sf-toolbar {        display: none !important;    }}</style><script nonce="b7cbf7b4ff33e4e0981fc79833d5e3d0">/*<![CDATA[*/    (function () {        Sfjs.loadToolbar('da679e');    })();/*]]>*/</script>
</body>
</html>
